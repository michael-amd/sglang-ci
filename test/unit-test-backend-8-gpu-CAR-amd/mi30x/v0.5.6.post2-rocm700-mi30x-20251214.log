==========================================
SGL Unit Test Log
==========================================
Test: test_custom_allreduce.TestCustomAllReduce
Image: rocm/sgl-dev:v0.5.6.post2-rocm700-mi30x-20251214
Container: sgl-dev_v0.5.6.post2-rocm700-mi30x-20251214
Hardware: mi30x
Machine: dell300x-pla-t12-38
Start time: 2025-12-14 11:03:22 CST
Test directory: /sgl-workspace/sglang/test/manual
Command: CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python3 -m unittest test_custom_allreduce.TestCustomAllReduce
==========================================

/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1204: ResourceWarning: unclosed file <_io.TextIOWrapper name='/dev/null' mode='w' encoding='UTF-8'>
  process_info = ray._private.services.start_gcs_server(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-03-27_761912_13/logs/monitor.out' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-03-27_761912_13/logs/monitor.err' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1425: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-03-27_761912_13/logs/dashboard.err' mode='a' encoding='utf-8'>
  self.start_api_server(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/utils.py:521: ResourceWarning: unclosed file <_io.TextIOWrapper name='/sys/fs/cgroup/cpu.max' mode='r' encoding='UTF-8'>
  max_file = open(cpu_max_file_name).read()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1247: ResourceWarning: unclosed file <_io.TextIOWrapper name='/dev/null' mode='w' encoding='UTF-8'>
  process_info = ray._private.services.start_raylet(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1469: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-03-27_761912_13/logs/log_monitor.err' mode='a' encoding='utf-8'>
  self.start_log_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-12-14 17:03:28,734	INFO worker.py:1852 -- Started a local Ray instance.
[36m(eager_allreduce pid=478)[0m [2025-12-14 17:03:36] INFO pynccl.py:83: sglang is using nccl==2.26.6
[33m(raylet)[0m [2025-12-14 17:03:38,726 E 355 385] (raylet) file_system_monitor.cc:116: /tmp/ray/session_2025-12-14_17-03-27_761912_13 is over 95% full, available space: 46.9959 GB; capacity: 1410.03 GB. Object creation will fail if spilling is required.
[36m(eager_allreduce pid=477)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(eager_allreduce pid=477)[0m [2025-12-14 17:03:47] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(eager_allreduce pid=477)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(eager_allreduce pid=477)[0m [2025-12-14 17:03:47] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(eager_allreduce pid=477)[0m [2025-12-14 17:03:47] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.
[36m(eager_allreduce pid=478)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(eager_allreduce pid=478)[0m [2025-12-14 17:03:47] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(eager_allreduce pid=478)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(eager_allreduce pid=478)[0m [2025-12-14 17:03:47] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(eager_allreduce pid=478)[0m [2025-12-14 17:03:47] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.
/usr/lib/python3.10/subprocess.py:1072: ResourceWarning: subprocess 290 is still running
  _warn("subprocess %s is still running" % self.pid,
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1204: ResourceWarning: unclosed file <_io.TextIOWrapper name='/dev/null' mode='w' encoding='UTF-8'>
  process_info = ray._private.services.start_gcs_server(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-03-50_001056_13/logs/monitor.out' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-03-50_001056_13/logs/monitor.err' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1425: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-03-50_001056_13/logs/dashboard.err' mode='a' encoding='utf-8'>
  self.start_api_server(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1469: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-03-50_001056_13/logs/log_monitor.err' mode='a' encoding='utf-8'>
  self.start_log_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-12-14 17:03:50,892	INFO worker.py:1852 -- Started a local Ray instance.
[36m(eager_allreduce pid=6430)[0m [2025-12-14 17:03:59] INFO pynccl.py:83: sglang is using nccl==2.26.6
[33m(raylet)[0m [2025-12-14 17:04:00,880 E 6313 6342] (raylet) file_system_monitor.cc:116: /tmp/ray/session_2025-12-14_17-03-50_001056_13 is over 95% full, available space: 47.3627 GB; capacity: 1410.03 GB. Object creation will fail if spilling is required.
[36m(eager_allreduce pid=6428)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(eager_allreduce pid=6428)[0m [2025-12-14 17:04:06] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(eager_allreduce pid=6428)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(eager_allreduce pid=6428)[0m [2025-12-14 17:04:06] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(eager_allreduce pid=6428)[0m [2025-12-14 17:04:06] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.
[36m(eager_allreduce pid=6432)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 3x across cluster][0m
[36m(eager_allreduce pid=6432)[0m [2025-12-14 17:04:06] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 3x across cluster][0m
[36m(eager_allreduce pid=6432)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 3x across cluster][0m
[36m(eager_allreduce pid=6432)[0m [2025-12-14 17:04:06] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 3x across cluster][0m
[36m(eager_allreduce pid=6432)[0m [2025-12-14 17:04:06] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.[32m [repeated 3x across cluster][0m
/usr/lib/python3.10/subprocess.py:1072: ResourceWarning: subprocess 6248 is still running
  _warn("subprocess %s is still running" % self.pid,
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-08_916642_13/logs/monitor.out' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-08_916642_13/logs/monitor.err' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1425: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-08_916642_13/logs/dashboard.err' mode='a' encoding='utf-8'>
  self.start_api_server(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1469: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-08_916642_13/logs/log_monitor.err' mode='a' encoding='utf-8'>
  self.start_log_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-12-14 17:04:09,799	INFO worker.py:1852 -- Started a local Ray instance.
[36m(eager_allreduce pid=12526)[0m [2025-12-14 17:04:18] INFO pynccl.py:83: sglang is using nccl==2.26.6
[33m(raylet)[0m [2025-12-14 17:04:19,788 E 12407 12437] (raylet) file_system_monitor.cc:116: /tmp/ray/session_2025-12-14_17-04-08_916642_13 is over 95% full, available space: 47.3616 GB; capacity: 1410.03 GB. Object creation will fail if spilling is required.
[36m(eager_allreduce pid=12532)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(eager_allreduce pid=12532)[0m [2025-12-14 17:04:25] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(eager_allreduce pid=12532)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(eager_allreduce pid=12532)[0m [2025-12-14 17:04:25] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(eager_allreduce pid=12532)[0m [2025-12-14 17:04:25] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.
[36m(eager_allreduce pid=12530)[0m [2025-12-14 17:04:25] WARNING quick_all_reduce.py:126: Custom quick allreduce is disabled due to an unsupported world size: 6. Supported world sizes: [2, 4, 8].
[36m(eager_allreduce pid=12522)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 5x across cluster][0m
[36m(eager_allreduce pid=12522)[0m [2025-12-14 17:04:25] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 5x across cluster][0m
[36m(eager_allreduce pid=12522)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 5x across cluster][0m
[36m(eager_allreduce pid=12522)[0m [2025-12-14 17:04:25] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 5x across cluster][0m
[36m(eager_allreduce pid=12522)[0m [2025-12-14 17:04:25] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.[32m [repeated 5x across cluster][0m
[36m(eager_allreduce pid=12526)[0m [2025-12-14 17:04:25] WARNING quick_all_reduce.py:126: Custom quick allreduce is disabled due to an unsupported world size: 6. Supported world sizes: [2, 4, 8].[32m [repeated 5x across cluster][0m
/usr/lib/python3.10/subprocess.py:1072: ResourceWarning: subprocess 12342 is still running
  _warn("subprocess %s is still running" % self.pid,
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-28_918697_13/logs/monitor.out' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-28_918697_13/logs/monitor.err' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1425: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-28_918697_13/logs/dashboard.err' mode='a' encoding='utf-8'>
  self.start_api_server(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1469: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-28_918697_13/logs/log_monitor.err' mode='a' encoding='utf-8'>
  self.start_log_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-12-14 17:04:29,915	INFO worker.py:1852 -- Started a local Ray instance.
[36m(eager_allreduce pid=18769)[0m [2025-12-14 17:04:38] INFO pynccl.py:83: sglang is using nccl==2.26.6
[33m(raylet)[0m [2025-12-14 17:04:39,907 E 18652 18682] (raylet) file_system_monitor.cc:116: /tmp/ray/session_2025-12-14_17-04-28_918697_13 is over 95% full, available space: 47.3605 GB; capacity: 1410.03 GB. Object creation will fail if spilling is required.
[36m(eager_allreduce pid=18779)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(eager_allreduce pid=18779)[0m [2025-12-14 17:04:47] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(eager_allreduce pid=18779)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(eager_allreduce pid=18779)[0m [2025-12-14 17:04:47] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(eager_allreduce pid=18779)[0m [2025-12-14 17:04:47] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.
[36m(eager_allreduce pid=18781)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 7x across cluster][0m
[36m(eager_allreduce pid=18781)[0m [2025-12-14 17:04:47] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 7x across cluster][0m
[36m(eager_allreduce pid=18781)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 7x across cluster][0m
[36m(eager_allreduce pid=18781)[0m [2025-12-14 17:04:47] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 7x across cluster][0m
[36m(eager_allreduce pid=18781)[0m [2025-12-14 17:04:47] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.[32m [repeated 7x across cluster][0m
/usr/lib/python3.10/subprocess.py:1072: ResourceWarning: subprocess 18587 is still running
  _warn("subprocess %s is still running" % self.pid,
ResourceWarning: Enable tracemalloc to get the object allocation traceback
./opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-51_248490_13/logs/monitor.out' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-51_248490_13/logs/monitor.err' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1425: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-51_248490_13/logs/dashboard.err' mode='a' encoding='utf-8'>
  self.start_api_server(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1469: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-04-51_248490_13/logs/log_monitor.err' mode='a' encoding='utf-8'>
  self.start_log_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-12-14 17:04:52,276	INFO worker.py:1852 -- Started a local Ray instance.
[36m(graph_allreduce pid=25162)[0m [2025-12-14 17:04:59] INFO pynccl.py:83: sglang is using nccl==2.26.6
[33m(raylet)[0m [2025-12-14 17:05:02,261 E 25047 25076] (raylet) file_system_monitor.cc:116: /tmp/ray/session_2025-12-14_17-04-51_248490_13 is over 95% full, available space: 47.3596 GB; capacity: 1410.03 GB. Object creation will fail if spilling is required.
[36m(graph_allreduce pid=25164)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(graph_allreduce pid=25164)[0m [2025-12-14 17:05:06] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(graph_allreduce pid=25164)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(graph_allreduce pid=25164)[0m [2025-12-14 17:05:06] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(graph_allreduce pid=25164)[0m [2025-12-14 17:05:06] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.
[36m(graph_allreduce pid=25164)[0m [aiter] Registering 2 cuda graph addresses
[36m(graph_allreduce pid=25164)[0m [2025-12-14 17:05:06] INFO custom_all_reduce.py:246: Registering 2 cuda graph addresses
[36m(graph_allreduce pid=25162)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(graph_allreduce pid=25162)[0m [2025-12-14 17:05:06] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(graph_allreduce pid=25162)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(graph_allreduce pid=25162)[0m [2025-12-14 17:05:06] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(graph_allreduce pid=25162)[0m [2025-12-14 17:05:06] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.
[36m(graph_allreduce pid=25162)[0m [aiter] Registering 0 cuda graph addresses[32m [repeated 479x across cluster][0m
[36m(graph_allreduce pid=25162)[0m [2025-12-14 17:05:09] INFO custom_all_reduce.py:246: Registering 0 cuda graph addresses[32m [repeated 479x across cluster][0m
/usr/lib/python3.10/subprocess.py:1072: ResourceWarning: subprocess 24982 is still running
  _warn("subprocess %s is still running" % self.pid,
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-10_895598_13/logs/monitor.out' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-10_895598_13/logs/monitor.err' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1425: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-10_895598_13/logs/dashboard.err' mode='a' encoding='utf-8'>
  self.start_api_server(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1469: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-10_895598_13/logs/log_monitor.err' mode='a' encoding='utf-8'>
  self.start_log_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-12-14 17:05:11,788	INFO worker.py:1852 -- Started a local Ray instance.
[36m(graph_allreduce pid=31111)[0m [2025-12-14 17:05:20] INFO pynccl.py:83: sglang is using nccl==2.26.6
[33m(raylet)[0m [2025-12-14 17:05:21,776 E 30992 31021] (raylet) file_system_monitor.cc:116: /tmp/ray/session_2025-12-14_17-05-10_895598_13 is over 95% full, available space: 47.3585 GB; capacity: 1410.03 GB. Object creation will fail if spilling is required.
[36m(graph_allreduce pid=31113)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(graph_allreduce pid=31113)[0m [2025-12-14 17:05:27] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(graph_allreduce pid=31113)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(graph_allreduce pid=31113)[0m [2025-12-14 17:05:27] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(graph_allreduce pid=31113)[0m [2025-12-14 17:05:27] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.
[36m(graph_allreduce pid=31111)[0m [aiter] Registering 2 cuda graph addresses
[36m(graph_allreduce pid=31111)[0m [2025-12-14 17:05:27] INFO custom_all_reduce.py:246: Registering 2 cuda graph addresses
[36m(graph_allreduce pid=31108)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 3x across cluster][0m
[36m(graph_allreduce pid=31108)[0m [2025-12-14 17:05:27] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 3x across cluster][0m
[36m(graph_allreduce pid=31108)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 3x across cluster][0m
[36m(graph_allreduce pid=31108)[0m [2025-12-14 17:05:27] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 3x across cluster][0m
[36m(graph_allreduce pid=31108)[0m [2025-12-14 17:05:27] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.[32m [repeated 3x across cluster][0m
[36m(graph_allreduce pid=31108)[0m [aiter] Registering 0 cuda graph addresses[32m [repeated 947x across cluster][0m
[36m(graph_allreduce pid=31108)[0m [2025-12-14 17:05:30] INFO custom_all_reduce.py:246: Registering 0 cuda graph addresses[32m [repeated 947x across cluster][0m
/usr/lib/python3.10/subprocess.py:1072: ResourceWarning: subprocess 30927 is still running
  _warn("subprocess %s is still running" % self.pid,
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-31_823354_13/logs/monitor.out' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-31_823354_13/logs/monitor.err' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1425: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-31_823354_13/logs/dashboard.err' mode='a' encoding='utf-8'>
  self.start_api_server(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1469: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-31_823354_13/logs/log_monitor.err' mode='a' encoding='utf-8'>
  self.start_log_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-12-14 17:05:32,692	INFO worker.py:1852 -- Started a local Ray instance.
[36m(graph_allreduce pid=37198)[0m [2025-12-14 17:05:41] INFO pynccl.py:83: sglang is using nccl==2.26.6
[33m(raylet)[0m [2025-12-14 17:05:42,682 E 37083 37113] (raylet) file_system_monitor.cc:116: /tmp/ray/session_2025-12-14_17-05-31_823354_13 is over 95% full, available space: 47.3574 GB; capacity: 1410.03 GB. Object creation will fail if spilling is required.
[36m(graph_allreduce pid=37205)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(graph_allreduce pid=37205)[0m [2025-12-14 17:05:48] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(graph_allreduce pid=37205)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(graph_allreduce pid=37205)[0m [2025-12-14 17:05:48] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(graph_allreduce pid=37205)[0m [2025-12-14 17:05:48] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.
[36m(graph_allreduce pid=37211)[0m [2025-12-14 17:05:48] WARNING quick_all_reduce.py:126: Custom quick allreduce is disabled due to an unsupported world size: 6. Supported world sizes: [2, 4, 8].
[36m(graph_allreduce pid=37211)[0m [aiter] Registering 2 cuda graph addresses
[36m(graph_allreduce pid=37211)[0m [2025-12-14 17:05:49] INFO custom_all_reduce.py:246: Registering 2 cuda graph addresses
[33m(raylet)[0m [2025-12-14 17:05:52,685 E 37083 37113] (raylet) file_system_monitor.cc:116: /tmp/ray/session_2025-12-14_17-05-31_823354_13 is over 95% full, available space: 47.3572 GB; capacity: 1410.03 GB. Object creation will fail if spilling is required.
[36m(graph_allreduce pid=37206)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 5x across cluster][0m
[36m(graph_allreduce pid=37206)[0m [2025-12-14 17:05:48] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 5x across cluster][0m
[36m(graph_allreduce pid=37213)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 5x across cluster][0m
[36m(graph_allreduce pid=37213)[0m [2025-12-14 17:05:48] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 5x across cluster][0m
[36m(graph_allreduce pid=37213)[0m [2025-12-14 17:05:48] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.[32m [repeated 5x across cluster][0m
[36m(graph_allreduce pid=37213)[0m [2025-12-14 17:05:48] WARNING quick_all_reduce.py:126: Custom quick allreduce is disabled due to an unsupported world size: 6. Supported world sizes: [2, 4, 8].[32m [repeated 5x across cluster][0m
[36m(graph_allreduce pid=37213)[0m [aiter] Registering 0 cuda graph addresses[32m [repeated 1433x across cluster][0m
[36m(graph_allreduce pid=37213)[0m [2025-12-14 17:05:53] INFO custom_all_reduce.py:246: Registering 0 cuda graph addresses[32m [repeated 1433x across cluster][0m
/usr/lib/python3.10/subprocess.py:1072: ResourceWarning: subprocess 37018 is still running
  _warn("subprocess %s is still running" % self.pid,
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-54_820530_13/logs/monitor.out' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1414: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-54_820530_13/logs/monitor.err' mode='a' encoding='utf-8'>
  self.start_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1425: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-54_820530_13/logs/dashboard.err' mode='a' encoding='utf-8'>
  self.start_api_server(
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/opt/venv/lib/python3.10/site-packages/ray/_private/node.py:1469: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/ray/session_2025-12-14_17-05-54_820530_13/logs/log_monitor.err' mode='a' encoding='utf-8'>
  self.start_log_monitor()
ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-12-14 17:05:55,703	INFO worker.py:1852 -- Started a local Ray instance.
[36m(graph_allreduce pid=43444)[0m [2025-12-14 17:06:05] INFO pynccl.py:83: sglang is using nccl==2.26.6
[33m(raylet)[0m [2025-12-14 17:06:05,694 E 43326 43356] (raylet) file_system_monitor.cc:116: /tmp/ray/session_2025-12-14_17-05-54_820530_13 is over 95% full, available space: 43.22 GB; capacity: 1410.03 GB. Object creation will fail if spilling is required.
[36m(graph_allreduce pid=43452)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(graph_allreduce pid=43452)[0m [2025-12-14 17:06:13] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[36m(graph_allreduce pid=43452)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(graph_allreduce pid=43452)[0m [2025-12-14 17:06:13] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so
[36m(graph_allreduce pid=43452)[0m [2025-12-14 17:06:13] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.
[33m(raylet)[0m [2025-12-14 17:06:15,697 E 43326 43356] (raylet) file_system_monitor.cc:116: /tmp/ray/session_2025-12-14_17-05-54_820530_13 is over 95% full, available space: 47.3561 GB; capacity: 1410.03 GB. Object creation will fail if spilling is required.
[36m(graph_allreduce pid=43447)[0m [aiter] Registering 2 cuda graph addresses
[36m(graph_allreduce pid=43447)[0m [2025-12-14 17:06:15] INFO custom_all_reduce.py:246: Registering 2 cuda graph addresses
[36m(graph_allreduce pid=43454)[0m [aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 7x across cluster][0m
[36m(graph_allreduce pid=43454)[0m [2025-12-14 17:06:13] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so[32m [repeated 7x across cluster][0m
[36m(graph_allreduce pid=43448)[0m [aiter] import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 7x across cluster][0m
[36m(graph_allreduce pid=43448)[0m [2025-12-14 17:06:13] INFO core.py:477: import [module_custom_all_reduce] under /sgl-workspace/aiter/aiter/jit/module_custom_all_reduce.so[32m [repeated 7x across cluster][0m
[36m(graph_allreduce pid=43448)[0m [2025-12-14 17:06:13] INFO custom_all_reduce.py:421: Using AiterCustomAllreduce for ROCm.[32m [repeated 7x across cluster][0m
[36m(graph_allreduce pid=43448)[0m [aiter] Registering 0 cuda graph addresses[32m [repeated 1871x across cluster][0m
[36m(graph_allreduce pid=43448)[0m [2025-12-14 17:06:18] INFO custom_all_reduce.py:246: Registering 0 cuda graph addresses[32m [repeated 1871x across cluster][0m
/usr/lib/python3.10/subprocess.py:1072: ResourceWarning: subprocess 43261 is still running
  _warn("subprocess %s is still running" % self.pid,
ResourceWarning: Enable tracemalloc to get the object allocation traceback
.
----------------------------------------------------------------------
Ran 2 tests in 172.373s

OK
[CI Test Method] TestCustomAllReduce.test_eager_allreduce
[36m(eager_allreduce pid=478)[0m [Gloo] Rank 0 is connected to 1 peer ranks. Expected number of connected peer ranks is : 1
[36m(eager_allreduce pid=478)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 5x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(eager_allreduce pid=477)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 2x across cluster][0m
[36m(eager_allreduce pid=6428)[0m [Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[36m(eager_allreduce pid=6428)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 9x across cluster][0m
[36m(eager_allreduce pid=6430)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 6x across cluster][0m
[36m(eager_allreduce pid=12522)[0m [Gloo] Rank 2 is connected to 5 peer ranks. Expected number of connected peer ranks is : 5
[36m(eager_allreduce pid=12522)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 13x across cluster][0m
[36m(eager_allreduce pid=12530)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 10x across cluster][0m
[36m(eager_allreduce pid=18769)[0m [Gloo] Rank 0 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[36m(eager_allreduce pid=18769)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 17x across cluster][0m
[36m(eager_allreduce pid=18783)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 14x across cluster][0m
[CI Test Method] TestCustomAllReduce.test_graph_allreduce
[36m(graph_allreduce pid=25164)[0m [Gloo] Rank 1 is connected to 1 peer ranks. Expected number of connected peer ranks is : 1
[36m(graph_allreduce pid=25164)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 5x across cluster][0m
[36m(graph_allreduce pid=25162)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 2x across cluster][0m
[36m(graph_allreduce pid=31108)[0m [Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[36m(graph_allreduce pid=31108)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 9x across cluster][0m
[36m(graph_allreduce pid=31110)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 6x across cluster][0m
[36m(graph_allreduce pid=37205)[0m [Gloo] Rank 2 is connected to 5 peer ranks. Expected number of connected peer ranks is : 5
[36m(graph_allreduce pid=37205)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 13x across cluster][0m
[36m(graph_allreduce pid=37213)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 10x across cluster][0m
[36m(graph_allreduce pid=43446)[0m [Gloo] Rank 1 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[36m(graph_allreduce pid=43446)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 17x across cluster][0m
[36m(graph_allreduce pid=43448)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 14x across cluster][0m
sys:1: DeprecationWarning: builtin type swigvarlink has no __module__ attribute

==========================================
End time: 2025-12-14 11:06:21 CST
Exit code: 0
Result: PASSED
==========================================
