Running benchmark with request rate: 16 (Run 1) for mode aiter
Run started at: 2025-12-14 12:27:47 PST
Executing: python3 -m sglang.bench_serving --backend sglang --tokenizer "/data/models/amd--grok-1-W4A8KV8" --dataset-name random --random-input 1024 --random-output 1024 --num-prompts 2400 --request-rate 16
Token indices sequence length is longer than the specified maximum sequence length for this model (9866 > 8192). Running this sequence through the model will result in indexing errors
benchmark_args=Namespace(backend='sglang', base_url=None, host='0.0.0.0', port=None, dataset_name='random', dataset_path='', model=None, served_model_name=None, tokenizer='/data/models/amd--grok-1-W4A8KV8', num_prompts=2400, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=1024, random_output_len=1024, random_range_ratio=0.0, image_count=1, image_resolution='1080p', random_image_count=False, image_format='jpeg', image_content='random', request_rate=16.0, use_trace_timestamps=False, max_concurrency=None, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, gsp_range_ratio=1.0, gsp_fast_prepare=False, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

WARNING It is recommended to use the `Chat` or `Instruct` model for benchmarking.
Because when the tokenizer counts the output tokens, if there is gibberish, it might count incorrectly.

Namespace(backend='sglang', base_url=None, host='0.0.0.0', port=30000, dataset_name='random', dataset_path='', model='/data/models/amd--grok-1-W4A8KV8', served_model_name=None, tokenizer='/data/models/amd--grok-1-W4A8KV8', num_prompts=2400, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=1024, random_output_len=1024, random_range_ratio=0.0, image_count=1, image_resolution='1080p', random_image_count=False, image_format='jpeg', image_content='random', request_rate=16.0, use_trace_timestamps=False, max_concurrency=None, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, gsp_range_ratio=1.0, gsp_fast_prepare=False, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

#Input tokens: 1222995
#Output tokens: 1213873
Starting warmup with 1 sequences...
Warmup completed with 1 sequences. Starting main benchmark run...
  0%|          | 0/2400 [00:00<?, ?it/s]  0%|          | 1/2400 [00:09<6:03:38,  9.09s/it]  0%|          | 2/2400 [00:09<2:36:43,  3.92s/it]  0%|          | 3/2400 [00:11<1:55:27,  2.89s/it]  0%|          | 4/2400 [00:11<1:23:02,  2.08s/it]  0%|          | 5/2400 [00:12<1:07:18,  1.69s/it]  0%|          | 6/2400 [00:13<55:52,  1.40s/it]    0%|          | 7/2400 [00:14<52:59,  1.33s/it]  0%|          | 8/2400 [00:15<37:39,  1.06it/s]  0%|          | 10/2400 [00:16<29:03,  1.37it/s]  0%|          | 11/2400 [00:16<29:38,  1.34it/s]  1%|          | 17/2400 [00:18<14:44,  2.69it/s]  1%|          | 19/2400 [00:20<22:12,  1.79it/s]  1%|          | 20/2400 [00:21<24:08,  1.64it/s]  1%|          | 21/2400 [00:21<25:14,  1.57it/s]  1%|          | 23/2400 [00:22<21:29,  1.84it/s]  1%|          | 26/2400 [00:22<13:22,  2.96it/s]  1%|          | 28/2400 [00:24<18:20,  2.16it/s]  1%|          | 29/2400 [00:24<18:55,  2.09it/s]  1%|▏         | 30/2400 [00:25<23:06,  1.71it/s]  1%|▏         | 31/2400 [00:26<21:58,  1.80it/s]  1%|▏         | 35/2400 [00:26<10:32,  3.74it/s]  2%|▏         | 37/2400 [00:27<10:51,  3.63it/s]  2%|▏         | 38/2400 [00:27<10:21,  3.80it/s]  2%|▏         | 39/2400 [00:27<12:07,  3.25it/s]  2%|▏         | 40/2400 [00:28<17:14,  2.28it/s]  2%|▏         | 42/2400 [00:28<12:09,  3.23it/s]  2%|▏         | 44/2400 [00:29<10:10,  3.86it/s]  2%|▏         | 45/2400 [00:29<10:25,  3.77it/s]  2%|▏         | 47/2400 [00:31<23:51,  1.64it/s]  2%|▏         | 53/2400 [00:32<09:57,  3.93it/s]  2%|▏         | 55/2400 [00:34<16:08,  2.42it/s]  2%|▏         | 57/2400 [00:34<15:48,  2.47it/s]  2%|▏         | 58/2400 [00:35<17:13,  2.27it/s]  2%|▏         | 59/2400 [00:36<19:58,  1.95it/s]  3%|▎         | 62/2400 [00:36<12:58,  3.00it/s]  3%|▎         | 63/2400 [00:38<21:29,  1.81it/s]  3%|▎         | 64/2400 [00:38<18:41,  2.08it/s]  3%|▎         | 65/2400 [00:39<20:11,  1.93it/s]  3%|▎         | 66/2400 [00:40<28:35,  1.36it/s]  3%|▎         | 67/2400 [00:40<24:10,  1.61it/s]  3%|▎         | 68/2400 [00:41<26:31,  1.46it/s]  3%|▎         | 69/2400 [00:42<25:16,  1.54it/s]  3%|▎         | 70/2400 [00:43<27:30,  1.41it/s]  3%|▎         | 71/2400 [00:43<28:21,  1.37it/s]  3%|▎         | 74/2400 [00:44<19:53,  1.95it/s]  3%|▎         | 75/2400 [00:45<18:42,  2.07it/s]  3%|▎         | 76/2400 [00:45<18:36,  2.08it/s]  3%|▎         | 79/2400 [00:46<13:31,  2.86it/s]  3%|▎         | 80/2400 [00:47<18:39,  2.07it/s]  3%|▎         | 82/2400 [00:48<17:54,  2.16it/s]  4%|▎         | 85/2400 [00:49<16:26,  2.35it/s]  4%|▎         | 87/2400 [00:50<20:12,  1.91it/s]  4%|▍         | 92/2400 [00:52<14:45,  2.61it/s]  4%|▍         | 95/2400 [00:52<12:26,  3.09it/s]  4%|▍         | 98/2400 [00:53<11:35,  3.31it/s]  4%|▍         | 99/2400 [00:53<12:22,  3.10it/s]  4%|▍         | 100/2400 [00:56<24:21,  1.57it/s]  4%|▍         | 102/2400 [00:57<26:41,  1.43it/s]  4%|▍         | 106/2400 [00:58<15:12,  2.51it/s]  4%|▍         | 107/2400 [00:58<16:41,  2.29it/s]  5%|▍         | 110/2400 [00:59<14:53,  2.56it/s]  5%|▍         | 112/2400 [01:00<14:46,  2.58it/s]  5%|▍         | 113/2400 [01:01<15:18,  2.49it/s]  5%|▍         | 116/2400 [01:01<11:56,  3.19it/s]  5%|▍         | 117/2400 [01:02<14:12,  2.68it/s]  5%|▍         | 118/2400 [01:02<15:33,  2.44it/s]  5%|▌         | 120/2400 [01:03<15:58,  2.38it/s]  5%|▌         | 121/2400 [01:05<29:58,  1.27it/s]  5%|▌         | 123/2400 [01:06<23:40,  1.60it/s]  5%|▌         | 125/2400 [01:09<32:11,  1.18it/s]  5%|▌         | 126/2400 [01:10<32:17,  1.17it/s]  5%|▌         | 128/2400 [01:10<23:05,  1.64it/s]  5%|▌         | 129/2400 [01:11<24:10,  1.57it/s]  6%|▌         | 132/2400 [01:11<13:39,  2.77it/s]  6%|▌         | 133/2400 [01:13<23:04,  1.64it/s]  6%|▌         | 135/2400 [01:13<16:25,  2.30it/s]  6%|▌         | 136/2400 [01:14<20:15,  1.86it/s]  6%|▌         | 140/2400 [01:15<15:50,  2.38it/s]  6%|▌         | 147/2400 [01:15<07:09,  5.24it/s]  6%|▋         | 154/2400 [01:16<05:18,  7.06it/s]  6%|▋         | 156/2400 [01:16<06:24,  5.83it/s]  7%|▋         | 158/2400 [01:17<06:11,  6.04it/s]  7%|▋         | 161/2400 [01:17<05:08,  7.26it/s]  7%|▋         | 163/2400 [01:17<06:42,  5.56it/s]  7%|▋         | 164/2400 [01:18<09:14,  4.03it/s]  7%|▋         | 170/2400 [01:18<04:48,  7.73it/s]  7%|▋         | 174/2400 [01:20<07:50,  4.74it/s]  7%|▋         | 178/2400 [01:20<06:09,  6.01it/s]  8%|▊         | 180/2400 [01:20<05:39,  6.53it/s]  8%|▊         | 183/2400 [01:21<05:04,  7.27it/s]  8%|▊         | 185/2400 [01:21<04:42,  7.85it/s]  8%|▊         | 188/2400 [01:22<06:45,  5.45it/s]  8%|▊         | 192/2400 [01:22<04:42,  7.83it/s]  8%|▊         | 201/2400 [01:22<03:30, 10.44it/s]  8%|▊         | 204/2400 [01:24<06:25,  5.70it/s]  9%|▊         | 207/2400 [01:25<08:13,  4.44it/s]  9%|▉         | 211/2400 [01:25<06:08,  5.94it/s]  9%|▉         | 219/2400 [01:26<04:36,  7.90it/s]  9%|▉         | 221/2400 [01:27<07:54,  4.59it/s]  9%|▉         | 222/2400 [01:28<10:01,  3.62it/s]  9%|▉         | 224/2400 [01:29<10:33,  3.44it/s] 10%|▉         | 231/2400 [01:29<05:34,  6.49it/s] 10%|▉         | 235/2400 [01:29<04:13,  8.53it/s] 10%|▉         | 238/2400 [01:29<03:53,  9.26it/s] 10%|█         | 240/2400 [01:30<06:22,  5.64it/s] 10%|█         | 242/2400 [01:31<05:43,  6.28it/s] 10%|█         | 245/2400 [01:33<11:16,  3.19it/s] 10%|█         | 249/2400 [01:33<07:36,  4.71it/s] 11%|█         | 255/2400 [01:33<04:39,  7.67it/s] 11%|█         | 258/2400 [01:35<08:37,  4.14it/s] 11%|█         | 260/2400 [01:35<07:56,  4.49it/s] 11%|█         | 262/2400 [01:36<11:43,  3.04it/s] 11%|█         | 265/2400 [01:37<11:09,  3.19it/s] 11%|█         | 269/2400 [01:37<07:35,  4.67it/s] 11%|█▏        | 272/2400 [01:38<07:57,  4.46it/s] 11%|█▏        | 274/2400 [01:39<08:04,  4.39it/s] 12%|█▏        | 281/2400 [01:40<06:57,  5.08it/s] 12%|█▏        | 282/2400 [01:41<09:29,  3.72it/s] 12%|█▏        | 286/2400 [01:41<06:43,  5.23it/s] 12%|█▏        | 292/2400 [01:41<04:11,  8.38it/s] 12%|█▏        | 295/2400 [01:43<08:06,  4.33it/s] 12%|█▏        | 297/2400 [01:44<09:37,  3.64it/s] 12%|█▏        | 299/2400 [01:44<07:59,  4.38it/s] 13%|█▎        | 309/2400 [01:44<03:34,  9.73it/s] 13%|█▎        | 314/2400 [01:46<07:21,  4.72it/s] 13%|█▎        | 318/2400 [01:47<07:40,  4.52it/s] 13%|█▎        | 323/2400 [01:48<05:33,  6.22it/s] 14%|█▎        | 326/2400 [01:48<04:39,  7.42it/s] 14%|█▍        | 331/2400 [01:48<03:21, 10.29it/s] 14%|█▍        | 335/2400 [01:48<03:49,  9.00it/s] 14%|█▍        | 338/2400 [01:49<03:46,  9.10it/s] 14%|█▍        | 340/2400 [01:50<07:40,  4.48it/s] 14%|█▍        | 343/2400 [01:50<05:51,  5.85it/s] 14%|█▍        | 347/2400 [01:51<06:20,  5.39it/s] 15%|█▍        | 352/2400 [01:52<06:14,  5.47it/s] 15%|█▍        | 354/2400 [01:53<09:03,  3.76it/s] 15%|█▍        | 357/2400 [01:53<06:53,  4.94it/s] 15%|█▌        | 362/2400 [01:54<04:25,  7.67it/s] 15%|█▌        | 367/2400 [01:54<03:15, 10.39it/s] 15%|█▌        | 370/2400 [01:55<06:50,  4.95it/s] 16%|█▌        | 373/2400 [01:56<07:16,  4.64it/s] 16%|█▌        | 378/2400 [01:56<04:47,  7.04it/s] 16%|█▌        | 388/2400 [01:56<02:35, 12.92it/s] 16%|█▋        | 393/2400 [01:57<03:19, 10.05it/s] 17%|█▋        | 397/2400 [01:58<03:08, 10.65it/s] 17%|█▋        | 400/2400 [01:58<02:55, 11.42it/s] 17%|█▋        | 403/2400 [01:59<04:51,  6.85it/s] 17%|█▋        | 405/2400 [01:59<04:19,  7.69it/s] 17%|█▋        | 408/2400 [02:10<04:18,  7.69it/s]