Running benchmark with request rate: 16 (Run 1) for mode aiter
Run started at: 2025-12-10 12:15:24 PST
Executing: python3 -m sglang.bench_serving --backend sglang --tokenizer "/data/models/amd--grok-1-W4A8KV8" --dataset-name random --random-input 1024 --random-output 1024 --num-prompts 2400 --request-rate 16
Token indices sequence length is longer than the specified maximum sequence length for this model (9866 > 8192). Running this sequence through the model will result in indexing errors
benchmark_args=Namespace(backend='sglang', base_url=None, host='0.0.0.0', port=None, dataset_name='random', dataset_path='', model=None, served_model_name=None, tokenizer='/data/models/amd--grok-1-W4A8KV8', num_prompts=2400, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=1024, random_output_len=1024, random_range_ratio=0.0, image_count=1, image_resolution='1080p', image_format='jpeg', image_content='random', request_rate=16.0, use_trace_timestamps=False, max_concurrency=None, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

WARNING It is recommended to use the `Chat` or `Instruct` model for benchmarking.
Because when the tokenizer counts the output tokens, if there is gibberish, it might count incorrectly.

Namespace(backend='sglang', base_url=None, host='0.0.0.0', port=30000, dataset_name='random', dataset_path='', model='/data/models/amd--grok-1-W4A8KV8', served_model_name=None, tokenizer='/data/models/amd--grok-1-W4A8KV8', num_prompts=2400, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=1024, random_output_len=1024, random_range_ratio=0.0, image_count=1, image_resolution='1080p', image_format='jpeg', image_content='random', request_rate=16.0, use_trace_timestamps=False, max_concurrency=None, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

#Input tokens: 1222995
#Output tokens: 1218922
Starting warmup with 1 sequences...
Warmup completed with 1 sequences. Starting main benchmark run...
  0%|          | 0/2400 [00:00<?, ?it/s]  0%|          | 1/2400 [00:05<3:28:04,  5.20s/it]  0%|          | 2/2400 [00:06<1:52:46,  2.82s/it]  0%|          | 3/2400 [00:07<1:27:35,  2.19s/it]  0%|          | 4/2400 [00:07<54:45,  1.37s/it]    0%|          | 5/2400 [00:09<53:15,  1.33s/it]  0%|          | 6/2400 [00:09<41:33,  1.04s/it]  0%|          | 7/2400 [00:12<1:02:50,  1.58s/it]  1%|          | 14/2400 [00:13<17:49,  2.23it/s]   1%|          | 16/2400 [00:13<15:51,  2.51it/s]  1%|          | 17/2400 [00:14<17:12,  2.31it/s]  1%|          | 18/2400 [00:14<15:11,  2.61it/s]  1%|          | 19/2400 [00:16<33:02,  1.20it/s]  1%|          | 21/2400 [00:17<22:33,  1.76it/s]  1%|          | 22/2400 [00:19<38:46,  1.02it/s]  1%|          | 23/2400 [00:19<31:53,  1.24it/s]  1%|          | 24/2400 [00:21<38:23,  1.03it/s]  1%|          | 25/2400 [00:22<42:06,  1.06s/it]  1%|          | 26/2400 [00:23<33:13,  1.19it/s]  1%|          | 28/2400 [00:23<22:40,  1.74it/s]  1%|▏         | 30/2400 [00:24<24:14,  1.63it/s]  1%|▏         | 31/2400 [00:25<23:30,  1.68it/s]  1%|▏         | 32/2400 [00:25<19:27,  2.03it/s]  1%|▏         | 33/2400 [00:28<41:05,  1.04s/it]  1%|▏         | 34/2400 [00:28<32:19,  1.22it/s]  1%|▏         | 35/2400 [00:29<31:01,  1.27it/s]  2%|▏         | 36/2400 [00:29<23:38,  1.67it/s]  2%|▏         | 37/2400 [00:29<20:59,  1.88it/s]  2%|▏         | 39/2400 [00:30<21:07,  1.86it/s]  2%|▏         | 40/2400 [00:31<23:22,  1.68it/s]  2%|▏         | 42/2400 [00:31<17:59,  2.19it/s]  2%|▏         | 45/2400 [00:32<12:42,  3.09it/s]  2%|▏         | 46/2400 [00:34<23:21,  1.68it/s]  2%|▏         | 47/2400 [00:34<23:37,  1.66it/s]  2%|▏         | 49/2400 [00:35<16:00,  2.45it/s]  2%|▏         | 51/2400 [00:35<11:46,  3.32it/s]  2%|▏         | 52/2400 [00:36<15:18,  2.56it/s]  2%|▏         | 53/2400 [00:37<24:07,  1.62it/s]  2%|▏         | 54/2400 [00:38<25:34,  1.53it/s]  2%|▏         | 55/2400 [00:38<22:47,  1.71it/s]  2%|▏         | 56/2400 [00:39<28:33,  1.37it/s]  2%|▏         | 57/2400 [00:40<33:02,  1.18it/s]  2%|▏         | 58/2400 [00:41<34:53,  1.12it/s]  3%|▎         | 64/2400 [00:43<17:41,  2.20it/s]  3%|▎         | 65/2400 [00:44<22:33,  1.73it/s]  3%|▎         | 68/2400 [00:45<18:39,  2.08it/s]  3%|▎         | 70/2400 [00:45<14:36,  2.66it/s]  3%|▎         | 71/2400 [00:46<14:04,  2.76it/s]  3%|▎         | 72/2400 [00:46<12:49,  3.03it/s]  3%|▎         | 73/2400 [00:47<15:37,  2.48it/s]  3%|▎         | 75/2400 [00:48<17:19,  2.24it/s]  3%|▎         | 76/2400 [00:48<16:44,  2.31it/s]  3%|▎         | 78/2400 [00:49<20:51,  1.85it/s]  3%|▎         | 79/2400 [00:50<21:42,  1.78it/s]  4%|▎         | 88/2400 [00:51<08:52,  4.34it/s]  4%|▎         | 89/2400 [00:51<08:43,  4.41it/s]  4%|▍         | 91/2400 [00:53<12:15,  3.14it/s]  4%|▍         | 92/2400 [00:53<12:01,  3.20it/s]  4%|▍         | 93/2400 [00:56<27:18,  1.41it/s]  4%|▍         | 95/2400 [00:56<19:37,  1.96it/s]  4%|▍         | 96/2400 [00:56<17:17,  2.22it/s]  4%|▍         | 97/2400 [00:57<19:48,  1.94it/s]  4%|▍         | 98/2400 [00:58<22:42,  1.69it/s]  4%|▍         | 102/2400 [00:58<10:24,  3.68it/s]  4%|▍         | 105/2400 [00:59<13:28,  2.84it/s]  4%|▍         | 106/2400 [01:00<17:59,  2.12it/s]  4%|▍         | 107/2400 [01:00<16:41,  2.29it/s]  4%|▍         | 108/2400 [01:01<16:17,  2.35it/s]  5%|▍         | 109/2400 [01:01<14:18,  2.67it/s]  5%|▍         | 110/2400 [01:01<12:33,  3.04it/s]  5%|▍         | 112/2400 [01:02<09:36,  3.97it/s]  5%|▍         | 114/2400 [01:02<08:46,  4.34it/s]  5%|▍         | 117/2400 [01:03<09:26,  4.03it/s]  5%|▌         | 122/2400 [01:03<05:10,  7.34it/s]  5%|▌         | 124/2400 [01:03<05:14,  7.23it/s]  5%|▌         | 126/2400 [01:04<07:31,  5.03it/s]  5%|▌         | 129/2400 [01:05<10:23,  3.64it/s]  6%|▌         | 132/2400 [01:05<07:44,  4.89it/s]  6%|▌         | 134/2400 [01:05<06:20,  5.96it/s]  6%|▌         | 136/2400 [01:07<10:38,  3.54it/s]  6%|▌         | 141/2400 [01:07<06:00,  6.27it/s]  6%|▌         | 143/2400 [01:07<05:07,  7.34it/s]  6%|▌         | 145/2400 [01:07<05:37,  6.68it/s]  6%|▌         | 147/2400 [01:09<10:59,  3.41it/s]  6%|▌         | 149/2400 [01:09<09:29,  3.96it/s]  6%|▋         | 153/2400 [01:09<06:36,  5.67it/s]  6%|▋         | 155/2400 [01:10<07:08,  5.24it/s]  6%|▋         | 156/2400 [01:10<06:39,  5.62it/s]  7%|▋         | 158/2400 [01:11<08:17,  4.51it/s]  7%|▋         | 160/2400 [01:11<06:24,  5.82it/s]  7%|▋         | 163/2400 [01:11<06:49,  5.47it/s]  7%|▋         | 165/2400 [01:11<05:54,  6.30it/s]  7%|▋         | 169/2400 [01:13<08:00,  4.64it/s]  7%|▋         | 171/2400 [01:13<08:14,  4.51it/s]  7%|▋         | 172/2400 [01:14<10:42,  3.47it/s]  7%|▋         | 175/2400 [01:14<08:46,  4.22it/s]  7%|▋         | 176/2400 [01:15<11:13,  3.30it/s]  8%|▊         | 180/2400 [01:15<06:49,  5.42it/s]  8%|▊         | 181/2400 [01:15<07:28,  4.94it/s]  8%|▊         | 182/2400 [01:17<13:59,  2.64it/s]  8%|▊         | 183/2400 [01:18<18:57,  1.95it/s]  8%|▊         | 186/2400 [01:20<22:48,  1.62it/s]  8%|▊         | 187/2400 [01:21<24:31,  1.50it/s]  8%|▊         | 194/2400 [01:21<09:12,  4.00it/s]  8%|▊         | 200/2400 [01:22<06:52,  5.34it/s]  8%|▊         | 202/2400 [01:22<07:14,  5.06it/s]  8%|▊         | 204/2400 [01:23<08:14,  4.45it/s]  9%|▊         | 205/2400 [01:23<10:17,  3.55it/s]  9%|▉         | 210/2400 [01:24<07:13,  5.05it/s]  9%|▉         | 214/2400 [01:24<05:15,  6.92it/s]  9%|▉         | 217/2400 [01:25<07:21,  4.95it/s]  9%|▉         | 220/2400 [01:26<06:36,  5.50it/s]  9%|▉         | 221/2400 [01:27<09:55,  3.66it/s]  9%|▉         | 226/2400 [01:28<08:29,  4.26it/s] 10%|▉         | 231/2400 [01:28<05:30,  6.57it/s] 10%|▉         | 233/2400 [01:28<06:08,  5.88it/s] 10%|▉         | 236/2400 [01:28<05:02,  7.15it/s] 10%|▉         | 238/2400 [01:29<05:05,  7.08it/s] 10%|█         | 241/2400 [01:29<05:25,  6.64it/s] 10%|█         | 244/2400 [01:30<07:40,  4.68it/s] 10%|█         | 249/2400 [01:30<04:45,  7.52it/s] 11%|█         | 253/2400 [01:32<07:08,  5.01it/s] 11%|█         | 256/2400 [01:33<07:47,  4.59it/s] 11%|█         | 262/2400 [01:33<04:53,  7.30it/s] 11%|█         | 264/2400 [01:33<06:04,  5.86it/s] 11%|█▏        | 270/2400 [01:35<06:27,  5.50it/s] 11%|█▏        | 273/2400 [01:35<05:14,  6.76it/s] 11%|█▏        | 275/2400 [01:35<06:47,  5.21it/s] 12%|█▏        | 278/2400 [01:36<08:10,  4.32it/s] 12%|█▏        | 285/2400 [01:37<04:32,  7.77it/s] 12%|█▏        | 291/2400 [01:37<04:14,  8.29it/s] 12%|█▏        | 293/2400 [01:37<04:21,  8.05it/s] 12%|█▏        | 295/2400 [01:38<04:30,  7.77it/s] 12%|█▏        | 297/2400 [01:38<06:00,  5.83it/s] 12%|█▏        | 298/2400 [01:39<06:34,  5.33it/s] 12%|█▏        | 299/2400 [01:40<09:53,  3.54it/s] 13%|█▎        | 305/2400 [01:40<04:42,  7.42it/s] 13%|█▎        | 309/2400 [01:40<04:59,  6.98it/s] 13%|█▎        | 312/2400 [01:41<06:08,  5.67it/s] 13%|█▎        | 318/2400 [01:41<03:55,  8.85it/s] 13%|█▎        | 321/2400 [01:43<08:41,  3.99it/s] 14%|█▎        | 325/2400 [01:44<06:20,  5.45it/s] 14%|█▍        | 333/2400 [01:44<05:00,  6.87it/s] 14%|█▍        | 335/2400 [01:45<05:19,  6.46it/s] 14%|█▍        | 337/2400 [01:46<07:56,  4.33it/s] 14%|█▍        | 345/2400 [01:46<04:19,  7.93it/s] 15%|█▍        | 349/2400 [01:47<04:18,  7.95it/s] 15%|█▍        | 351/2400 [01:47<04:29,  7.61it/s] 15%|█▍        | 353/2400 [01:48<06:40,  5.12it/s] 15%|█▍        | 355/2400 [01:50<11:42,  2.91it/s] 15%|█▍        | 358/2400 [01:50<08:39,  3.93it/s] 15%|█▌        | 361/2400 [01:51<10:33,  3.22it/s] 15%|█▌        | 364/2400 [01:51<07:42,  4.40it/s] 15%|█▌        | 366/2400 [01:52<09:00,  3.76it/s] 15%|█▌        | 370/2400 [01:53<09:12,  3.67it/s] 16%|█▌        | 372/2400 [01:53<07:54,  4.28it/s] 16%|█▌        | 373/2400 [01:55<15:36,  2.17it/s] 16%|█▌        | 376/2400 [01:55<10:20,  3.26it/s] 16%|█▌        | 378/2400 [01:58<18:44,  1.80it/s] 16%|█▌        | 380/2400 [01:59<17:30,  1.92it/s] 16%|█▌        | 383/2400 [01:59<11:55,  2.82it/s] 16%|█▌        | 385/2400 [01:59<09:17,  3.61it/s] 16%|█▌        | 387/2400 [01:59<08:00,  4.19it/s] 16%|█▌        | 389/2400 [02:00<08:16,  4.05it/s] 16%|█▋        | 390/2400 [02:01<11:56,  2.81it/s] 16%|█▋        | 393/2400 [02:02<10:25,  3.21it/s] 17%|█▋        | 405/2400 [02:02<03:28,  9.58it/s] 17%|█▋        | 410/2400 [02:03<04:59,  6.64it/s] 17%|█▋        | 412/2400 [02:03<04:59,  6.64it/s] 17%|█▋        | 414/2400 [02:04<05:01,  6.59it/s] 17%|█▋        | 416/2400 [02:05<06:52,  4.81it/s] 18%|█▊        | 420/2400 [02:05<04:43,  6.99it/s] 18%|█▊        | 428/2400 [02:05<02:55, 11.25it/s] 18%|█▊        | 431/2400 [02:05<02:41, 12.17it/s] 18%|█▊        | 436/2400 [02:06<04:36,  7.11it/s] 18%|█▊        | 440/2400 [02:07<03:32,  9.21it/s] 19%|█▊        | 445/2400 [02:07<03:51,  8.45it/s] 19%|█▊        | 447/2400 [02:08<04:31,  7.19it/s] 19%|█▉        | 451/2400 [02:09<06:21,  5.11it/s] 19%|█▉        | 451/2400 [02:20<06:21,  5.11it/s]