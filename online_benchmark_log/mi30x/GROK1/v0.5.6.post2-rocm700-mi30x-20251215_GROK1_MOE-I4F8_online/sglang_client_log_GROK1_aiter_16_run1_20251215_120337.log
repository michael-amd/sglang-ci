Running benchmark with request rate: 16 (Run 1) for mode aiter
Run started at: 2025-12-15 12:27:57 PST
Executing: python3 -m sglang.bench_serving --backend sglang --tokenizer "/data/models/amd--grok-1-W4A8KV8" --dataset-name random --random-input 1024 --random-output 1024 --num-prompts 2400 --request-rate 16
Token indices sequence length is longer than the specified maximum sequence length for this model (9866 > 8192). Running this sequence through the model will result in indexing errors
benchmark_args=Namespace(backend='sglang', base_url=None, host='0.0.0.0', port=None, dataset_name='random', dataset_path='', model=None, served_model_name=None, tokenizer='/data/models/amd--grok-1-W4A8KV8', num_prompts=2400, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=1024, random_output_len=1024, random_range_ratio=0.0, image_count=1, image_resolution='1080p', random_image_count=False, image_format='jpeg', image_content='random', request_rate=16.0, use_trace_timestamps=False, max_concurrency=None, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, gsp_range_ratio=1.0, gsp_fast_prepare=False, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

WARNING It is recommended to use the `Chat` or `Instruct` model for benchmarking.
Because when the tokenizer counts the output tokens, if there is gibberish, it might count incorrectly.

Namespace(backend='sglang', base_url=None, host='0.0.0.0', port=30000, dataset_name='random', dataset_path='', model='/data/models/amd--grok-1-W4A8KV8', served_model_name=None, tokenizer='/data/models/amd--grok-1-W4A8KV8', num_prompts=2400, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=1024, random_output_len=1024, random_range_ratio=0.0, image_count=1, image_resolution='1080p', random_image_count=False, image_format='jpeg', image_content='random', request_rate=16.0, use_trace_timestamps=False, max_concurrency=None, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, gsp_range_ratio=1.0, gsp_fast_prepare=False, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

#Input tokens: 1222995
#Output tokens: 1213873
Starting warmup with 1 sequences...
Warmup completed with 1 sequences. Starting main benchmark run...
  0%|          | 0/2400 [00:00<?, ?it/s]  0%|          | 1/2400 [00:09<6:15:04,  9.38s/it]  0%|          | 2/2400 [00:10<2:50:26,  4.26s/it]  0%|          | 3/2400 [00:10<1:47:20,  2.69s/it]  0%|          | 4/2400 [00:11<1:10:10,  1.76s/it]  0%|          | 5/2400 [00:11<46:30,  1.17s/it]    0%|          | 6/2400 [00:12<51:20,  1.29s/it]  0%|          | 7/2400 [00:13<42:10,  1.06s/it]  0%|          | 8/2400 [00:13<30:29,  1.31it/s]  0%|          | 10/2400 [00:13<16:58,  2.35it/s]  1%|          | 13/2400 [00:13<09:28,  4.20it/s]  1%|          | 15/2400 [00:14<13:15,  3.00it/s]  1%|          | 16/2400 [00:16<25:30,  1.56it/s]  1%|          | 17/2400 [00:18<29:57,  1.33it/s]  1%|          | 18/2400 [00:18<30:46,  1.29it/s]  1%|          | 19/2400 [00:19<24:38,  1.61it/s]  1%|          | 20/2400 [00:19<19:29,  2.03it/s]  1%|          | 21/2400 [00:21<36:46,  1.08it/s]  1%|          | 22/2400 [00:21<32:38,  1.21it/s]  1%|          | 23/2400 [00:22<32:51,  1.21it/s]  1%|          | 24/2400 [00:23<32:57,  1.20it/s]  1%|          | 25/2400 [00:23<24:49,  1.59it/s]  1%|          | 27/2400 [00:24<19:58,  1.98it/s]  1%|▏         | 30/2400 [00:24<12:52,  3.07it/s]  1%|▏         | 32/2400 [00:25<14:23,  2.74it/s]  1%|▏         | 33/2400 [00:25<13:58,  2.82it/s]  1%|▏         | 34/2400 [00:26<17:12,  2.29it/s]  2%|▏         | 36/2400 [00:27<13:58,  2.82it/s]  2%|▏         | 39/2400 [00:27<10:53,  3.61it/s]  2%|▏         | 40/2400 [00:27<10:04,  3.90it/s]  2%|▏         | 42/2400 [00:28<12:45,  3.08it/s]  2%|▏         | 44/2400 [00:29<15:40,  2.50it/s]  2%|▏         | 51/2400 [00:30<08:13,  4.76it/s]  2%|▏         | 53/2400 [00:30<07:22,  5.30it/s]  2%|▏         | 54/2400 [00:31<09:33,  4.09it/s]  2%|▏         | 55/2400 [00:32<12:31,  3.12it/s]  2%|▏         | 56/2400 [00:32<11:14,  3.47it/s]  2%|▏         | 57/2400 [00:34<24:07,  1.62it/s]  2%|▏         | 58/2400 [00:34<25:27,  1.53it/s]  2%|▎         | 60/2400 [00:35<20:34,  1.90it/s]  3%|▎         | 61/2400 [00:36<23:26,  1.66it/s]  3%|▎         | 62/2400 [00:36<19:31,  2.00it/s]  3%|▎         | 64/2400 [00:37<16:58,  2.29it/s]  3%|▎         | 65/2400 [00:38<23:58,  1.62it/s]  3%|▎         | 66/2400 [00:39<22:41,  1.71it/s]  3%|▎         | 68/2400 [00:40<20:55,  1.86it/s]  3%|▎         | 71/2400 [00:41<22:14,  1.74it/s]  3%|▎         | 73/2400 [00:42<21:09,  1.83it/s]  3%|▎         | 74/2400 [00:43<20:01,  1.94it/s]  3%|▎         | 75/2400 [00:43<18:12,  2.13it/s]  3%|▎         | 76/2400 [00:44<24:06,  1.61it/s]  3%|▎         | 78/2400 [00:45<19:39,  1.97it/s]  3%|▎         | 81/2400 [00:46<15:48,  2.44it/s]  4%|▎         | 85/2400 [00:46<09:42,  3.98it/s]  4%|▎         | 89/2400 [00:47<10:36,  3.63it/s]  4%|▍         | 90/2400 [00:48<14:18,  2.69it/s]  4%|▍         | 94/2400 [00:48<08:45,  4.39it/s]  4%|▍         | 96/2400 [00:51<18:40,  2.06it/s]  4%|▍         | 98/2400 [00:52<17:46,  2.16it/s]  4%|▍         | 99/2400 [00:53<22:12,  1.73it/s]  4%|▍         | 100/2400 [00:53<20:12,  1.90it/s]  4%|▍         | 103/2400 [00:55<18:29,  2.07it/s]  4%|▍         | 105/2400 [00:55<14:06,  2.71it/s]  4%|▍         | 106/2400 [00:56<18:40,  2.05it/s]  4%|▍         | 107/2400 [00:56<15:45,  2.43it/s]  4%|▍         | 108/2400 [00:57<21:14,  1.80it/s]  5%|▍         | 109/2400 [00:57<19:35,  1.95it/s]  5%|▍         | 112/2400 [00:58<12:44,  2.99it/s]  5%|▍         | 113/2400 [00:58<11:03,  3.45it/s]  5%|▍         | 114/2400 [00:59<15:00,  2.54it/s]  5%|▍         | 118/2400 [00:59<09:47,  3.88it/s]  5%|▍         | 119/2400 [01:00<11:11,  3.40it/s]  5%|▌         | 123/2400 [01:00<07:51,  4.83it/s]  5%|▌         | 126/2400 [01:00<05:42,  6.65it/s]  5%|▌         | 128/2400 [01:02<11:31,  3.29it/s]  5%|▌         | 129/2400 [01:02<10:53,  3.47it/s]  5%|▌         | 131/2400 [01:03<14:40,  2.58it/s]  6%|▌         | 132/2400 [01:07<35:18,  1.07it/s]  6%|▌         | 134/2400 [01:09<33:47,  1.12it/s]  6%|▌         | 135/2400 [01:09<30:48,  1.23it/s]  6%|▌         | 137/2400 [01:10<25:33,  1.48it/s]  6%|▌         | 141/2400 [01:10<14:30,  2.60it/s]  6%|▌         | 142/2400 [01:11<17:24,  2.16it/s]  6%|▌         | 144/2400 [01:12<17:42,  2.12it/s]  6%|▌         | 148/2400 [01:12<10:48,  3.47it/s]  6%|▋         | 153/2400 [01:13<06:29,  5.77it/s]  6%|▋         | 156/2400 [01:14<09:22,  3.99it/s]  7%|▋         | 160/2400 [01:14<06:27,  5.78it/s]  7%|▋         | 162/2400 [01:14<05:55,  6.30it/s]  7%|▋         | 164/2400 [01:16<09:47,  3.81it/s]  7%|▋         | 166/2400 [01:17<14:15,  2.61it/s]  7%|▋         | 173/2400 [01:17<06:46,  5.48it/s]  7%|▋         | 176/2400 [01:18<07:18,  5.07it/s]  7%|▋         | 178/2400 [01:19<09:20,  3.96it/s]  8%|▊         | 180/2400 [01:20<12:20,  3.00it/s]  8%|▊         | 183/2400 [01:22<15:34,  2.37it/s]  8%|▊         | 186/2400 [01:23<14:01,  2.63it/s]  8%|▊         | 188/2400 [01:23<11:26,  3.22it/s]  8%|▊         | 193/2400 [01:24<08:09,  4.51it/s]  8%|▊         | 197/2400 [01:24<07:09,  5.13it/s]  8%|▊         | 199/2400 [01:25<07:34,  4.85it/s]  8%|▊         | 201/2400 [01:25<07:50,  4.67it/s]  8%|▊         | 203/2400 [01:27<14:48,  2.47it/s]  9%|▊         | 209/2400 [01:27<07:47,  4.69it/s]  9%|▉         | 214/2400 [01:28<07:09,  5.09it/s]  9%|▉         | 216/2400 [01:28<06:14,  5.84it/s]  9%|▉         | 219/2400 [01:29<07:25,  4.90it/s]  9%|▉         | 221/2400 [01:30<07:23,  4.91it/s]  9%|▉         | 224/2400 [01:30<08:42,  4.17it/s]  9%|▉         | 225/2400 [01:31<11:09,  3.25it/s] 10%|▉         | 228/2400 [01:31<08:03,  4.50it/s] 10%|▉         | 229/2400 [01:32<09:59,  3.62it/s] 10%|▉         | 234/2400 [01:33<06:46,  5.33it/s] 10%|▉         | 235/2400 [01:33<07:18,  4.93it/s] 10%|▉         | 236/2400 [01:33<07:49,  4.61it/s] 10%|▉         | 238/2400 [01:34<12:02,  2.99it/s] 10%|█         | 243/2400 [01:35<06:16,  5.73it/s] 10%|█         | 246/2400 [01:35<06:13,  5.76it/s] 10%|█         | 248/2400 [01:35<06:10,  5.80it/s] 10%|█         | 251/2400 [01:37<09:29,  3.77it/s] 11%|█         | 254/2400 [01:37<06:53,  5.19it/s] 11%|█         | 257/2400 [01:39<11:06,  3.22it/s] 11%|█         | 259/2400 [01:39<09:07,  3.91it/s] 11%|█         | 265/2400 [01:40<09:05,  3.91it/s] 11%|█         | 266/2400 [01:41<09:18,  3.82it/s] 11%|█         | 267/2400 [01:41<09:29,  3.75it/s] 11%|█         | 269/2400 [01:44<19:47,  1.79it/s] 12%|█▏        | 276/2400 [01:44<08:50,  4.01it/s] 12%|█▏        | 282/2400 [01:44<06:00,  5.88it/s] 12%|█▏        | 284/2400 [01:44<05:38,  6.24it/s] 12%|█▏        | 286/2400 [01:45<06:13,  5.67it/s] 12%|█▏        | 289/2400 [01:45<06:08,  5.73it/s] 12%|█▏        | 292/2400 [01:46<07:44,  4.54it/s] 12%|█▏        | 297/2400 [01:46<05:06,  6.86it/s] 13%|█▎        | 302/2400 [01:47<05:20,  6.56it/s] 13%|█▎        | 304/2400 [01:49<10:09,  3.44it/s] 13%|█▎        | 307/2400 [01:50<11:01,  3.17it/s] 13%|█▎        | 312/2400 [01:50<07:02,  4.95it/s] 13%|█▎        | 314/2400 [01:51<07:40,  4.53it/s] 13%|█▎        | 316/2400 [01:52<08:50,  3.93it/s] 13%|█▎        | 320/2400 [01:53<08:10,  4.24it/s] 13%|█▎        | 321/2400 [01:53<07:40,  4.52it/s] 14%|█▎        | 329/2400 [01:53<04:02,  8.53it/s] 14%|█▍        | 334/2400 [01:54<05:20,  6.44it/s] 14%|█▍        | 335/2400 [02:10<05:20,  6.44it/s]