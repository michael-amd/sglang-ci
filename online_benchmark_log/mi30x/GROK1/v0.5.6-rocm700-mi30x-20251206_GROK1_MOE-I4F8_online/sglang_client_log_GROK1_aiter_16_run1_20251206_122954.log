Running benchmark with request rate: 16 (Run 1) for mode aiter
Run started at: 2025-12-06 12:54:13 PST
Executing: python3 -m sglang.bench_serving --backend sglang --tokenizer "/data/models/amd--grok-1-W4A8KV8" --dataset-name random --random-input 1024 --random-output 1024 --num-prompts 2400 --request-rate 16
Token indices sequence length is longer than the specified maximum sequence length for this model (9866 > 8192). Running this sequence through the model will result in indexing errors
benchmark_args=Namespace(backend='sglang', base_url=None, host='0.0.0.0', port=None, dataset_name='random', dataset_path='', model=None, served_model_name=None, tokenizer='/data/models/amd--grok-1-W4A8KV8', num_prompts=2400, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=1024, random_output_len=1024, random_range_ratio=0.0, image_count=1, image_resolution='1080p', image_format='jpeg', image_content='random', request_rate=16.0, use_trace_timestamps=False, max_concurrency=None, output_file=None, output_details=False, disable_tqdm=False, disable_stream=False, return_logprob=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

WARNING It is recommended to use the `Chat` or `Instruct` model for benchmarking.
Because when the tokenizer counts the output tokens, if there is gibberish, it might count incorrectly.

Namespace(backend='sglang', base_url=None, host='0.0.0.0', port=30000, dataset_name='random', dataset_path='', model='/data/models/amd--grok-1-W4A8KV8', served_model_name=None, tokenizer='/data/models/amd--grok-1-W4A8KV8', num_prompts=2400, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=1024, random_output_len=1024, random_range_ratio=0.0, image_count=1, image_resolution='1080p', image_format='jpeg', image_content='random', request_rate=16.0, use_trace_timestamps=False, max_concurrency=None, output_file=None, output_details=False, disable_tqdm=False, disable_stream=False, return_logprob=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

#Input tokens: 1222995
#Output tokens: 1218922
Starting warmup with 1 sequences...
Warmup completed with 1 sequences. Starting main benchmark run...
  0%|          | 0/2400 [00:00<?, ?it/s]  0%|          | 1/2400 [00:05<3:28:58,  5.23s/it]  0%|          | 2/2400 [00:05<1:44:07,  2.61s/it]  0%|          | 3/2400 [00:06<1:00:30,  1.51s/it]  0%|          | 4/2400 [00:07<59:52,  1.50s/it]    0%|          | 5/2400 [00:08<49:53,  1.25s/it]  0%|          | 6/2400 [00:09<41:59,  1.05s/it]  0%|          | 9/2400 [00:09<18:11,  2.19it/s]  0%|          | 10/2400 [00:10<22:06,  1.80it/s]  0%|          | 12/2400 [00:10<16:11,  2.46it/s]  1%|          | 13/2400 [00:11<23:35,  1.69it/s]  1%|          | 15/2400 [00:12<18:57,  2.10it/s]  1%|          | 16/2400 [00:12<19:10,  2.07it/s]  1%|          | 17/2400 [00:13<17:58,  2.21it/s]  1%|          | 18/2400 [00:13<15:03,  2.64it/s]  1%|          | 19/2400 [00:15<34:17,  1.16it/s]  1%|          | 20/2400 [00:15<26:01,  1.52it/s]  1%|          | 21/2400 [00:16<31:38,  1.25it/s]  1%|          | 23/2400 [00:17<18:30,  2.14it/s]  1%|          | 24/2400 [00:17<19:55,  1.99it/s]  1%|          | 25/2400 [00:17<17:33,  2.25it/s]  1%|          | 26/2400 [00:18<17:55,  2.21it/s]  1%|          | 27/2400 [00:19<28:28,  1.39it/s]  1%|          | 28/2400 [00:20<23:19,  1.70it/s]  1%|          | 29/2400 [00:20<17:50,  2.22it/s]  1%|▏         | 30/2400 [00:20<17:11,  2.30it/s]  1%|▏         | 31/2400 [00:21<20:28,  1.93it/s]  1%|▏         | 33/2400 [00:21<12:35,  3.13it/s]  2%|▏         | 36/2400 [00:22<10:52,  3.62it/s]  2%|▏         | 37/2400 [00:22<12:19,  3.20it/s]  2%|▏         | 40/2400 [00:23<09:53,  3.98it/s]  2%|▏         | 42/2400 [00:24<17:27,  2.25it/s]  2%|▏         | 43/2400 [00:25<17:11,  2.28it/s]  2%|▏         | 44/2400 [00:27<29:49,  1.32it/s]  2%|▏         | 45/2400 [00:28<29:54,  1.31it/s]  2%|▏         | 46/2400 [00:28<26:29,  1.48it/s]  2%|▏         | 50/2400 [00:29<14:08,  2.77it/s]  2%|▏         | 51/2400 [00:29<12:41,  3.09it/s]  2%|▏         | 52/2400 [00:30<19:41,  1.99it/s]  2%|▏         | 55/2400 [00:30<12:06,  3.23it/s]  2%|▏         | 56/2400 [00:31<14:21,  2.72it/s]  2%|▏         | 58/2400 [00:31<10:59,  3.55it/s]  2%|▏         | 59/2400 [00:32<17:03,  2.29it/s]  2%|▎         | 60/2400 [00:33<18:58,  2.06it/s]  3%|▎         | 61/2400 [00:33<18:23,  2.12it/s]  3%|▎         | 62/2400 [00:34<17:56,  2.17it/s]  3%|▎         | 64/2400 [00:34<16:33,  2.35it/s]  3%|▎         | 66/2400 [00:35<11:15,  3.46it/s]  3%|▎         | 67/2400 [00:35<10:20,  3.76it/s]  3%|▎         | 70/2400 [00:35<06:28,  5.99it/s]  3%|▎         | 71/2400 [00:36<13:37,  2.85it/s]  3%|▎         | 74/2400 [00:36<08:55,  4.34it/s]  3%|▎         | 75/2400 [00:37<15:04,  2.57it/s]  3%|▎         | 77/2400 [00:38<15:03,  2.57it/s]  3%|▎         | 79/2400 [00:39<12:51,  3.01it/s]  3%|▎         | 80/2400 [00:39<13:31,  2.86it/s]  3%|▎         | 82/2400 [00:39<10:00,  3.86it/s]  4%|▎         | 85/2400 [00:40<12:19,  3.13it/s]  4%|▎         | 86/2400 [00:41<12:25,  3.10it/s]  4%|▎         | 87/2400 [00:41<11:18,  3.41it/s]  4%|▎         | 88/2400 [00:41<10:20,  3.72it/s]  4%|▎         | 89/2400 [00:43<20:51,  1.85it/s]  4%|▍         | 90/2400 [00:43<18:51,  2.04it/s]  4%|▍         | 91/2400 [00:43<16:30,  2.33it/s]  4%|▍         | 93/2400 [00:43<12:06,  3.18it/s]  4%|▍         | 95/2400 [00:45<15:10,  2.53it/s]  4%|▍         | 97/2400 [00:45<14:25,  2.66it/s]  4%|▍         | 98/2400 [00:45<12:48,  3.00it/s]  4%|▍         | 99/2400 [00:46<11:28,  3.34it/s]  4%|▍         | 103/2400 [00:46<05:58,  6.40it/s]  4%|▍         | 106/2400 [00:46<05:00,  7.64it/s]  4%|▍         | 108/2400 [00:47<09:43,  3.93it/s]  5%|▍         | 111/2400 [00:47<07:02,  5.42it/s]  5%|▍         | 113/2400 [00:48<06:08,  6.21it/s]  5%|▍         | 115/2400 [00:48<06:42,  5.68it/s]  5%|▍         | 117/2400 [00:48<05:48,  6.55it/s]  5%|▍         | 118/2400 [00:49<07:34,  5.02it/s]  5%|▍         | 119/2400 [00:50<14:02,  2.71it/s]  5%|▌         | 120/2400 [00:51<18:05,  2.10it/s]  5%|▌         | 122/2400 [00:51<14:55,  2.54it/s]  5%|▌         | 123/2400 [00:51<13:07,  2.89it/s]  5%|▌         | 125/2400 [00:52<14:21,  2.64it/s]  5%|▌         | 127/2400 [00:53<18:17,  2.07it/s]  5%|▌         | 130/2400 [00:54<11:12,  3.37it/s]  6%|▌         | 133/2400 [00:54<08:14,  4.58it/s]  6%|▌         | 134/2400 [00:55<11:22,  3.32it/s]  6%|▌         | 135/2400 [00:56<20:15,  1.86it/s]  6%|▌         | 136/2400 [00:57<18:02,  2.09it/s]  6%|▌         | 138/2400 [00:57<12:43,  2.96it/s]  6%|▌         | 140/2400 [00:58<17:14,  2.18it/s]  6%|▌         | 143/2400 [00:59<15:37,  2.41it/s]  6%|▋         | 152/2400 [01:00<08:27,  4.43it/s]  6%|▋         | 153/2400 [01:01<09:10,  4.09it/s]  6%|▋         | 154/2400 [01:02<12:15,  3.05it/s]  6%|▋         | 155/2400 [01:03<16:53,  2.22it/s]  6%|▋         | 156/2400 [01:03<16:50,  2.22it/s]  7%|▋         | 158/2400 [01:04<15:25,  2.42it/s]  7%|▋         | 161/2400 [01:04<09:44,  3.83it/s]  7%|▋         | 162/2400 [01:05<15:26,  2.41it/s]  7%|▋         | 163/2400 [01:05<13:48,  2.70it/s]  7%|▋         | 164/2400 [01:06<12:59,  2.87it/s]  7%|▋         | 165/2400 [01:06<12:13,  3.05it/s]  7%|▋         | 167/2400 [01:06<10:35,  3.51it/s]  7%|▋         | 169/2400 [01:07<08:30,  4.37it/s]  7%|▋         | 173/2400 [01:07<05:22,  6.91it/s]  7%|▋         | 174/2400 [01:07<07:30,  4.94it/s]  7%|▋         | 175/2400 [01:08<10:51,  3.42it/s]  7%|▋         | 178/2400 [01:09<11:52,  3.12it/s]  8%|▊         | 184/2400 [01:10<07:57,  4.64it/s]  8%|▊         | 188/2400 [01:11<07:31,  4.90it/s]  8%|▊         | 189/2400 [01:12<10:15,  3.59it/s]  8%|▊         | 190/2400 [01:12<11:28,  3.21it/s]  8%|▊         | 194/2400 [01:12<06:55,  5.31it/s]  8%|▊         | 198/2400 [01:13<06:27,  5.68it/s]  8%|▊         | 200/2400 [01:13<06:08,  5.98it/s]  8%|▊         | 202/2400 [01:13<05:29,  6.67it/s]  9%|▊         | 207/2400 [01:15<07:05,  5.16it/s]  9%|▉         | 210/2400 [01:16<11:19,  3.23it/s]  9%|▉         | 217/2400 [01:17<06:31,  5.58it/s]  9%|▉         | 219/2400 [01:17<06:56,  5.24it/s]  9%|▉         | 223/2400 [01:19<08:57,  4.05it/s]  9%|▉         | 224/2400 [01:19<08:43,  4.16it/s]  9%|▉         | 225/2400 [01:19<10:06,  3.59it/s] 10%|▉         | 228/2400 [01:21<13:08,  2.76it/s] 10%|▉         | 229/2400 [01:21<14:06,  2.56it/s] 10%|▉         | 236/2400 [01:22<06:04,  5.94it/s] 10%|█         | 240/2400 [01:22<05:44,  6.27it/s] 10%|█         | 245/2400 [01:23<04:46,  7.53it/s] 10%|█         | 248/2400 [01:23<05:41,  6.30it/s] 10%|█         | 250/2400 [01:24<05:27,  6.56it/s] 10%|█         | 252/2400 [01:25<08:06,  4.42it/s] 11%|█         | 254/2400 [01:25<06:59,  5.11it/s] 11%|█         | 261/2400 [01:26<06:05,  5.85it/s] 11%|█         | 262/2400 [01:26<07:02,  5.06it/s] 11%|█         | 265/2400 [01:26<05:50,  6.08it/s] 11%|█         | 266/2400 [01:27<07:11,  4.95it/s] 11%|█         | 268/2400 [01:28<08:53,  4.00it/s] 11%|█▏        | 270/2400 [01:28<07:48,  4.55it/s] 11%|█▏        | 274/2400 [01:29<07:30,  4.72it/s] 12%|█▏        | 280/2400 [01:29<05:29,  6.43it/s] 12%|█▏        | 281/2400 [01:30<06:34,  5.37it/s] 12%|█▏        | 283/2400 [01:30<07:37,  4.63it/s] 12%|█▏        | 286/2400 [01:31<08:44,  4.03it/s] 12%|█▏        | 294/2400 [01:32<04:16,  8.20it/s] 12%|█▏        | 298/2400 [01:32<04:13,  8.29it/s] 12%|█▎        | 300/2400 [01:32<04:19,  8.08it/s] 13%|█▎        | 304/2400 [01:32<03:25, 10.22it/s] 13%|█▎        | 308/2400 [01:33<04:00,  8.70it/s] 13%|█▎        | 310/2400 [01:34<04:39,  7.48it/s] 13%|█▎        | 312/2400 [01:34<06:46,  5.14it/s] 13%|█▎        | 317/2400 [01:35<04:59,  6.95it/s] 13%|█▎        | 318/2400 [01:35<07:06,  4.88it/s] 13%|█▎        | 319/2400 [01:36<07:26,  4.66it/s] 13%|█▎        | 322/2400 [01:36<05:49,  5.94it/s] 13%|█▎        | 323/2400 [01:36<05:55,  5.85it/s] 14%|█▎        | 324/2400 [01:37<10:22,  3.34it/s] 14%|█▎        | 325/2400 [01:37<09:00,  3.84it/s] 14%|█▍        | 333/2400 [01:37<03:10, 10.86it/s] 14%|█▍        | 340/2400 [01:38<02:46, 12.35it/s] 14%|█▍        | 342/2400 [01:39<05:41,  6.02it/s] 14%|█▍        | 344/2400 [01:41<09:17,  3.69it/s] 14%|█▍        | 347/2400 [01:41<07:13,  4.74it/s] 15%|█▍        | 353/2400 [01:42<06:01,  5.66it/s] 15%|█▍        | 357/2400 [01:42<04:54,  6.94it/s] 15%|█▍        | 359/2400 [01:43<07:16,  4.68it/s] 15%|█▌        | 364/2400 [01:43<04:50,  7.02it/s] 15%|█▌        | 366/2400 [01:44<05:57,  5.70it/s] 15%|█▌        | 369/2400 [01:44<04:39,  7.27it/s] 15%|█▌        | 371/2400 [01:46<10:06,  3.35it/s] 16%|█▌        | 374/2400 [01:46<07:39,  4.41it/s] 16%|█▌        | 377/2400 [01:46<05:48,  5.81it/s] 16%|█▌        | 379/2400 [01:46<05:21,  6.29it/s] 16%|█▌        | 381/2400 [01:46<05:13,  6.45it/s] 16%|█▌        | 383/2400 [01:47<05:52,  5.73it/s] 16%|█▌        | 385/2400 [01:48<08:19,  4.03it/s] 16%|█▋        | 395/2400 [01:50<06:50,  4.88it/s] 17%|█▋        | 400/2400 [01:50<06:11,  5.39it/s] 17%|█▋        | 401/2400 [01:51<07:57,  4.19it/s] 17%|█▋        | 407/2400 [01:51<04:59,  6.65it/s] 17%|█▋        | 413/2400 [01:52<04:11,  7.91it/s] 17%|█▋        | 419/2400 [01:52<03:25,  9.64it/s] 18%|█▊        | 421/2400 [01:53<03:55,  8.39it/s] 18%|█▊        | 423/2400 [01:53<05:09,  6.38it/s] 18%|█▊        | 431/2400 [01:53<02:50, 11.57it/s] 18%|█▊        | 435/2400 [01:54<02:19, 14.10it/s] 18%|█▊        | 440/2400 [01:54<02:47, 11.69it/s] 18%|█▊        | 443/2400 [01:55<03:27,  9.41it/s] 19%|█▊        | 445/2400 [01:55<03:24,  9.55it/s] 19%|█▊        | 447/2400 [01:55<03:37,  8.99it/s] 19%|█▊        | 449/2400 [01:56<05:43,  5.68it/s] 19%|█▉        | 451/2400 [01:56<04:50,  6.71it/s] 19%|█▉        | 456/2400 [01:56<03:47,  8.53it/s] 19%|█▉        | 459/2400 [01:57<04:00,  8.06it/s] 19%|█▉        | 461/2400 [01:57<04:05,  7.91it/s] 19%|█▉        | 462/2400 [01:57<04:44,  6.81it/s] 19%|█▉        | 464/2400 [01:58<04:41,  6.89it/s] 19%|█▉        | 465/2400 [01:59<10:24,  3.10it/s] 20%|█▉        | 472/2400 [01:59<04:20,  7.39it/s] 20%|█▉        | 477/2400 [02:00<04:42,  6.81it/s] 20%|██        | 483/2400 [02:00<03:56,  8.11it/s] 20%|██        | 485/2400 [02:01<04:01,  7.92it/s] 20%|██        | 487/2400 [02:01<04:06,  7.78it/s] 20%|██        | 489/2400 [02:02<05:46,  5.52it/s] 21%|██        | 499/2400 [02:02<02:39, 11.91it/s] 21%|██        | 502/2400 [02:03<03:56,  8.01it/s] 21%|██        | 504/2400 [02:04<05:10,  6.10it/s] 21%|██        | 506/2400 [02:04<04:36,  6.84it/s] 21%|██▏       | 513/2400 [02:04<02:35, 12.12it/s] 22%|██▏       | 518/2400 [02:05<03:54,  8.02it/s] 22%|██▏       | 521/2400 [02:05<04:10,  7.50it/s] 22%|██▏       | 523/2400 [02:06<06:25,  4.87it/s] 22%|██▏       | 525/2400 [02:07<05:41,  5.49it/s] 22%|██▏       | 531/2400 [02:07<03:19,  9.37it/s] 22%|██▏       | 537/2400 [02:07<03:31,  8.83it/s] 22%|██▏       | 539/2400 [02:08<03:39,  8.47it/s] 23%|██▎       | 544/2400 [02:09<04:06,  7.53it/s] 23%|██▎       | 546/2400 [02:09<03:44,  8.25it/s] 23%|██▎       | 548/2400 [02:09<03:18,  9.32it/s] 23%|██▎       | 551/2400 [02:09<04:05,  7.52it/s] 23%|██▎       | 553/2400 [02:10<04:08,  7.42it/s] 23%|██▎       | 555/2400 [02:10<05:14,  5.86it/s] 23%|██▎       | 557/2400 [02:10<05:01,  6.12it/s] 23%|██▎       | 558/2400 [02:12<09:28,  3.24it/s] 23%|██▎       | 563/2400 [02:12<05:18,  5.77it/s] 23%|██▎       | 563/2400 [02:30<05:18,  5.77it/s]