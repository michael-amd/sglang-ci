Starting GSM8K accuracy test at: 2025-11-12 18:39:11 PST
Executing GSM8K test Run 1 ...
Traceback (most recent call last):
  File "/sgl-workspace/sglang/benchmark/gsm8k/bench_sglang.py", line 148, in <module>
    main(args)
  File "/sgl-workspace/sglang/benchmark/gsm8k/bench_sglang.py", line 89, in main
    states = few_shot_gsm8k.run_batch(
  File "/sgl-workspace/sglang/python/sglang/lang/ir.py", line 294, in run_batch
    return run_program_batch(
  File "/sgl-workspace/sglang/python/sglang/lang/interpreter.py", line 107, in run_program_batch
    cache_program(program, backend)
  File "/sgl-workspace/sglang/python/sglang/lang/interpreter.py", line 247, in cache_program
    backend.cache_prefix(prefix)
  File "/sgl-workspace/sglang/python/sglang/lang/backend/runtime_endpoint.py", line 80, in cache_prefix
    res = http_request(
  File "/sgl-workspace/sglang/python/sglang/utils.py", line 169, in http_request
    resp = urllib.request.urlopen(req, data=data, cafile=verify)
  File "/usr/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/usr/lib/python3.10/urllib/request.py", line 519, in open
    response = self._open(req, data)
  File "/usr/lib/python3.10/urllib/request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "/usr/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/usr/lib/python3.10/urllib/request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
  File "/usr/lib/python3.10/urllib/request.py", line 1352, in do_open
    r = h.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response
Run 1 completed in 29 seconds
Run 1: Accuracy not found, defaulting to 0
Run 1: Accuracy: 0
Executing GSM8K test Run 2 ...
Traceback (most recent call last):
  File "/usr/lib/python3.10/urllib/request.py", line 1348, in do_open
    h.request(req.get_method(), req.selector, req.data, headers,
  File "/usr/lib/python3.10/http/client.py", line 1283, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1329, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/usr/lib/python3.10/http/client.py", line 942, in connect
    self.sock = self._create_connection(
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 833, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/sgl-workspace/sglang/benchmark/gsm8k/bench_sglang.py", line 148, in <module>
    main(args)
  File "/sgl-workspace/sglang/benchmark/gsm8k/bench_sglang.py", line 48, in main
    set_default_backend(select_sglang_backend(args))
  File "/sgl-workspace/sglang/python/sglang/test/test_utils.py", line 408, in select_sglang_backend
    backend = RuntimeEndpoint(f"{args.host}:{args.port}")
  File "/sgl-workspace/sglang/python/sglang/lang/backend/runtime_endpoint.py", line 40, in __init__
    res = http_request(
  File "/sgl-workspace/sglang/python/sglang/utils.py", line 169, in http_request
    resp = urllib.request.urlopen(req, data=data, cafile=verify)
  File "/usr/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/usr/lib/python3.10/urllib/request.py", line 519, in open
    response = self._open(req, data)
  File "/usr/lib/python3.10/urllib/request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "/usr/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/usr/lib/python3.10/urllib/request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
  File "/usr/lib/python3.10/urllib/request.py", line 1351, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [Errno 111] Connection refused>
Run 2 completed in 4 seconds
Run 2: Accuracy not found, defaulting to 0
Run 2: Accuracy: 0
Executing GSM8K test Run 3 ...
Traceback (most recent call last):
  File "/usr/lib/python3.10/urllib/request.py", line 1348, in do_open
    h.request(req.get_method(), req.selector, req.data, headers,
  File "/usr/lib/python3.10/http/client.py", line 1283, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1329, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/usr/lib/python3.10/http/client.py", line 942, in connect
    self.sock = self._create_connection(
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 833, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/sgl-workspace/sglang/benchmark/gsm8k/bench_sglang.py", line 148, in <module>
    main(args)
  File "/sgl-workspace/sglang/benchmark/gsm8k/bench_sglang.py", line 48, in main
    set_default_backend(select_sglang_backend(args))
  File "/sgl-workspace/sglang/python/sglang/test/test_utils.py", line 408, in select_sglang_backend
    backend = RuntimeEndpoint(f"{args.host}:{args.port}")
  File "/sgl-workspace/sglang/python/sglang/lang/backend/runtime_endpoint.py", line 40, in __init__
    res = http_request(
  File "/sgl-workspace/sglang/python/sglang/utils.py", line 169, in http_request
    resp = urllib.request.urlopen(req, data=data, cafile=verify)
  File "/usr/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/usr/lib/python3.10/urllib/request.py", line 519, in open
    response = self._open(req, data)
  File "/usr/lib/python3.10/urllib/request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "/usr/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/usr/lib/python3.10/urllib/request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
  File "/usr/lib/python3.10/urllib/request.py", line 1351, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [Errno 111] Connection refused>
Run 3 completed in 4 seconds
Run 3: Accuracy not found, defaulting to 0
Run 3: Accuracy: 0
Executing GSM8K test Run 4 ...
Traceback (most recent call last):
  File "/usr/lib/python3.10/urllib/request.py", line 1348, in do_open
    h.request(req.get_method(), req.selector, req.data, headers,
  File "/usr/lib/python3.10/http/client.py", line 1283, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1329, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/usr/lib/python3.10/http/client.py", line 942, in connect
    self.sock = self._create_connection(
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 833, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/sgl-workspace/sglang/benchmark/gsm8k/bench_sglang.py", line 148, in <module>
    main(args)
  File "/sgl-workspace/sglang/benchmark/gsm8k/bench_sglang.py", line 48, in main
    set_default_backend(select_sglang_backend(args))
  File "/sgl-workspace/sglang/python/sglang/test/test_utils.py", line 408, in select_sglang_backend
    backend = RuntimeEndpoint(f"{args.host}:{args.port}")
  File "/sgl-workspace/sglang/python/sglang/lang/backend/runtime_endpoint.py", line 40, in __init__
    res = http_request(
  File "/sgl-workspace/sglang/python/sglang/utils.py", line 169, in http_request
    resp = urllib.request.urlopen(req, data=data, cafile=verify)
  File "/usr/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/usr/lib/python3.10/urllib/request.py", line 519, in open
    response = self._open(req, data)
  File "/usr/lib/python3.10/urllib/request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "/usr/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/usr/lib/python3.10/urllib/request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
  File "/usr/lib/python3.10/urllib/request.py", line 1351, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [Errno 111] Connection refused>
Run 4 completed in 4 seconds
Run 4: Accuracy not found, defaulting to 0
Run 4: Accuracy: 0
Executing GSM8K test Run 5 ...
Traceback (most recent call last):
  File "/usr/lib/python3.10/urllib/request.py", line 1348, in do_open
    h.request(req.get_method(), req.selector, req.data, headers,
  File "/usr/lib/python3.10/http/client.py", line 1283, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1329, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/usr/lib/python3.10/http/client.py", line 942, in connect
    self.sock = self._create_connection(
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 833, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/sgl-workspace/sglang/benchmark/gsm8k/bench_sglang.py", line 148, in <module>
    main(args)
  File "/sgl-workspace/sglang/benchmark/gsm8k/bench_sglang.py", line 48, in main
    set_default_backend(select_sglang_backend(args))
  File "/sgl-workspace/sglang/python/sglang/test/test_utils.py", line 408, in select_sglang_backend
    backend = RuntimeEndpoint(f"{args.host}:{args.port}")
  File "/sgl-workspace/sglang/python/sglang/lang/backend/runtime_endpoint.py", line 40, in __init__
    res = http_request(
  File "/sgl-workspace/sglang/python/sglang/utils.py", line 169, in http_request
    resp = urllib.request.urlopen(req, data=data, cafile=verify)
  File "/usr/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/usr/lib/python3.10/urllib/request.py", line 519, in open
    response = self._open(req, data)
  File "/usr/lib/python3.10/urllib/request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "/usr/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/usr/lib/python3.10/urllib/request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
  File "/usr/lib/python3.10/urllib/request.py", line 1351, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [Errno 111] Connection refused>
Run 5 completed in 4 seconds
Run 5: Accuracy not found, defaulting to 0
Run 5: Accuracy: 0
GSM8K test completed in 45 seconds
Average Accuracy over 5 runs: 0.000
Average accuracy (0.000) is below threshold (0.93).
