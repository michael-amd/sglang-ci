Running benchmark with request rate: 8 (Run 3) for mode aiter
Run started at: 2025-11-06 17:23:54 PST
Executing: python3 -m sglang.bench_serving --backend sglang --tokenizer "/data/amd--grok-1-W4A8KV8" --dataset-name random --random-input 1024 --random-output 1024 --num-prompts 2400 --request-rate 8
Token indices sequence length is longer than the specified maximum sequence length for this model (9866 > 8192). Running this sequence through the model will result in indexing errors
benchmark_args=Namespace(backend='sglang', base_url=None, host='0.0.0.0', port=None, dataset_name='random', dataset_path='', model=None, served_model_name=None, tokenizer='/data/amd--grok-1-W4A8KV8', num_prompts=2400, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=1024, random_output_len=1024, random_range_ratio=0.0, image_count=1, image_resolution='1080p', image_format='jpeg', image_content='random', request_rate=8.0, use_trace_timestamps=False, max_concurrency=None, output_file=None, output_details=False, disable_tqdm=False, disable_stream=False, return_logprob=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, profile_activities=['CPU', 'GPU'], lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

WARNING It is recommended to use the `Chat` or `Instruct` model for benchmarking.
Because when the tokenizer counts the output tokens, if there is gibberish, it might count incorrectly.

Namespace(backend='sglang', base_url=None, host='0.0.0.0', port=30000, dataset_name='random', dataset_path='', model='/data/amd--grok-1-W4A8KV8', served_model_name=None, tokenizer='/data/amd--grok-1-W4A8KV8', num_prompts=2400, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=1024, random_output_len=1024, random_range_ratio=0.0, image_count=1, image_resolution='1080p', image_format='jpeg', image_content='random', request_rate=8.0, use_trace_timestamps=False, max_concurrency=None, output_file=None, output_details=False, disable_tqdm=False, disable_stream=False, return_logprob=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, profile_activities=['CPU', 'GPU'], lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

#Input tokens: 1222995
#Output tokens: 1218922
Starting warmup with 1 sequences...
Warmup completed with 1 sequences. Starting main benchmark run...
  0%|          | 0/2400 [00:00<?, ?it/s]  0%|          | 1/2400 [00:10<7:00:09, 10.51s/it]  0%|          | 2/2400 [00:23<7:58:00, 11.96s/it]  0%|          | 5/2400 [00:24<2:21:45,  3.55s/it]  0%|          | 6/2400 [00:26<2:07:04,  3.18s/it]  0%|          | 7/2400 [00:26<1:39:17,  2.49s/it]  0%|          | 8/2400 [00:27<1:14:46,  1.88s/it]  0%|          | 10/2400 [00:27<49:00,  1.23s/it]   0%|          | 11/2400 [00:28<44:39,  1.12s/it]  0%|          | 12/2400 [00:28<34:59,  1.14it/s]  1%|          | 13/2400 [00:31<48:46,  1.23s/it]  1%|          | 14/2400 [00:31<37:53,  1.05it/s]  1%|          | 15/2400 [00:31<28:19,  1.40it/s]  1%|          | 17/2400 [00:31<18:08,  2.19it/s]  1%|          | 18/2400 [00:32<24:08,  1.64it/s]  1%|          | 19/2400 [00:33<26:04,  1.52it/s]  1%|          | 21/2400 [00:35<33:53,  1.17it/s]  1%|          | 22/2400 [00:36<36:44,  1.08it/s]  1%|          | 23/2400 [00:37<28:36,  1.38it/s]  1%|          | 24/2400 [00:39<50:11,  1.27s/it]  1%|          | 25/2400 [00:49<2:22:13,  3.59s/it]  1%|          | 26/2400 [00:50<1:47:12,  2.71s/it]  1%|          | 27/2400 [00:50<1:20:11,  2.03s/it]  1%|          | 28/2400 [00:52<1:16:32,  1.94s/it]  1%|          | 29/2400 [00:56<1:41:18,  2.56s/it]  1%|▏         | 32/2400 [00:56<48:47,  1.24s/it]    1%|▏         | 33/2400 [00:57<42:34,  1.08s/it]  1%|▏         | 34/2400 [00:59<49:24,  1.25s/it]  1%|▏         | 35/2400 [01:01<58:47,  1.49s/it]  2%|▏         | 36/2400 [01:03<1:02:02,  1.57s/it]  2%|▏         | 37/2400 [01:03<47:10,  1.20s/it]    2%|▏         | 38/2400 [01:04<46:34,  1.18s/it]  2%|▏         | 39/2400 [01:11<1:57:34,  2.99s/it]  2%|▏         | 42/2400 [01:12<58:20,  1.48s/it]    2%|▏         | 43/2400 [01:14<58:58,  1.50s/it]  2%|▏         | 45/2400 [01:14<38:19,  1.02it/s]  2%|▏         | 46/2400 [01:14<32:52,  1.19it/s]  2%|▏         | 47/2400 [01:17<46:28,  1.19s/it]  2%|▏         | 48/2400 [01:18<49:09,  1.25s/it]  2%|▏         | 49/2400 [01:19<41:10,  1.05s/it]  2%|▏         | 53/2400 [01:21<32:46,  1.19it/s]  2%|▏         | 54/2400 [01:22<33:42,  1.16it/s]  2%|▏         | 56/2400 [01:26<46:07,  1.18s/it]  2%|▏         | 58/2400 [01:26<33:23,  1.17it/s]  2%|▏         | 59/2400 [01:28<38:37,  1.01it/s]  2%|▎         | 60/2400 [01:28<34:18,  1.14it/s]  3%|▎         | 61/2400 [01:32<58:07,  1.49s/it]  3%|▎         | 62/2400 [01:34<1:08:47,  1.77s/it]  3%|▎         | 64/2400 [01:35<46:44,  1.20s/it]    3%|▎         | 65/2400 [01:36<39:34,  1.02s/it]  3%|▎         | 66/2400 [01:36<36:12,  1.07it/s]  3%|▎         | 68/2400 [01:37<22:58,  1.69it/s]  3%|▎         | 72/2400 [01:38<20:29,  1.89it/s]  3%|▎         | 73/2400 [01:39<20:06,  1.93it/s]  3%|▎         | 76/2400 [01:40<15:10,  2.55it/s]  3%|▎         | 77/2400 [01:40<13:53,  2.79it/s]  3%|▎         | 78/2400 [01:40<13:50,  2.79it/s]  3%|▎         | 79/2400 [01:41<15:59,  2.42it/s]  3%|▎         | 80/2400 [01:42<26:53,  1.44it/s]  3%|▎         | 82/2400 [01:50<1:18:08,  2.02s/it]  4%|▎         | 84/2400 [01:50<50:36,  1.31s/it]    4%|▎         | 86/2400 [01:51<34:47,  1.11it/s]  4%|▎         | 88/2400 [01:52<29:50,  1.29it/s]  4%|▎         | 89/2400 [01:55<45:40,  1.19s/it]  4%|▍         | 90/2400 [01:55<37:28,  1.03it/s]  4%|▍         | 91/2400 [01:56<38:20,  1.00it/s]  4%|▍         | 94/2400 [01:57<25:58,  1.48it/s]  4%|▍         | 96/2400 [01:59<26:58,  1.42it/s]  4%|▍         | 99/2400 [02:00<22:51,  1.68it/s]  4%|▍         | 103/2400 [02:00<14:17,  2.68it/s]  4%|▍         | 106/2400 [02:02<17:56,  2.13it/s]  4%|▍         | 107/2400 [02:04<25:03,  1.53it/s]  4%|▍         | 108/2400 [02:05<25:09,  1.52it/s]  5%|▍         | 109/2400 [02:05<23:18,  1.64it/s]  5%|▍         | 112/2400 [02:06<17:31,  2.18it/s]  5%|▍         | 114/2400 [02:07<19:34,  1.95it/s]  5%|▍         | 119/2400 [02:08<11:36,  3.28it/s]  5%|▌         | 120/2400 [02:13<35:37,  1.07it/s]  5%|▌         | 123/2400 [02:13<23:54,  1.59it/s]  5%|▌         | 125/2400 [02:14<23:41,  1.60it/s]  5%|▌         | 126/2400 [02:17<36:36,  1.04it/s]  5%|▌         | 127/2400 [02:18<33:11,  1.14it/s]  5%|▌         | 128/2400 [02:18<30:55,  1.22it/s]  5%|▌         | 131/2400 [02:19<18:46,  2.01it/s]  6%|▌         | 134/2400 [02:19<13:16,  2.85it/s]  6%|▌         | 137/2400 [02:20<10:03,  3.75it/s]  6%|▌         | 139/2400 [02:21<16:29,  2.29it/s]  6%|▌         | 140/2400 [02:22<15:14,  2.47it/s]  6%|▌         | 141/2400 [02:22<15:04,  2.50it/s]  6%|▌         | 142/2400 [02:23<16:50,  2.23it/s]  6%|▌         | 145/2400 [02:24<18:13,  2.06it/s]  6%|▋         | 150/2400 [02:25<10:53,  3.44it/s]  6%|▋         | 152/2400 [02:27<17:30,  2.14it/s]  6%|▋         | 153/2400 [02:27<16:11,  2.31it/s]  7%|▋         | 157/2400 [02:28<11:32,  3.24it/s]  7%|▋         | 160/2400 [02:28<10:34,  3.53it/s]  7%|▋         | 161/2400 [02:29<12:07,  3.08it/s]  7%|▋         | 162/2400 [02:30<13:30,  2.76it/s]  7%|▋         | 163/2400 [02:32<25:52,  1.44it/s]  7%|▋         | 166/2400 [02:32<16:43,  2.23it/s]  7%|▋         | 168/2400 [02:35<28:59,  1.28it/s]  7%|▋         | 169/2400 [02:40<56:16,  1.51s/it]  7%|▋         | 170/2400 [02:40<46:29,  1.25s/it]  7%|▋         | 171/2400 [02:41<38:08,  1.03s/it]  7%|▋         | 173/2400 [02:42<31:19,  1.18it/s]  7%|▋         | 176/2400 [02:42<18:25,  2.01it/s]  8%|▊         | 181/2400 [02:43<11:28,  3.22it/s]  8%|▊         | 184/2400 [02:44<12:49,  2.88it/s]  8%|▊         | 185/2400 [02:45<15:30,  2.38it/s]  8%|▊         | 188/2400 [02:46<15:39,  2.35it/s]  8%|▊         | 190/2400 [02:46<12:52,  2.86it/s]  8%|▊         | 193/2400 [02:49<17:47,  2.07it/s]  8%|▊         | 195/2400 [02:50<17:36,  2.09it/s]  8%|▊         | 197/2400 [02:51<18:06,  2.03it/s]  8%|▊         | 198/2400 [02:52<21:52,  1.68it/s]  8%|▊         | 200/2400 [02:52<15:54,  2.30it/s]  8%|▊         | 201/2400 [02:52<14:48,  2.47it/s]  8%|▊         | 202/2400 [02:53<16:12,  2.26it/s]  8%|▊         | 204/2400 [02:53<11:54,  3.07it/s]  9%|▊         | 205/2400 [02:55<22:06,  1.65it/s]  9%|▊         | 207/2400 [02:55<16:51,  2.17it/s]  9%|▊         | 208/2400 [02:55<15:13,  2.40it/s]  9%|▉         | 215/2400 [02:56<07:26,  4.90it/s]  9%|▉         | 218/2400 [02:58<11:59,  3.03it/s]  9%|▉         | 223/2400 [03:01<16:51,  2.15it/s]  9%|▉         | 224/2400 [03:03<23:04,  1.57it/s]  9%|▉         | 226/2400 [03:04<22:11,  1.63it/s] 10%|▉         | 229/2400 [03:05<17:50,  2.03it/s] 10%|▉         | 232/2400 [03:06<16:37,  2.17it/s] 10%|▉         | 235/2400 [03:09<19:53,  1.81it/s] 10%|▉         | 239/2400 [03:09<13:16,  2.71it/s] 10%|█         | 240/2400 [03:09<12:45,  2.82it/s] 10%|█         | 242/2400 [03:11<17:39,  2.04it/s] 10%|█         | 247/2400 [03:12<12:41,  2.83it/s] 10%|█         | 249/2400 [03:16<25:35,  1.40it/s] 10%|█         | 252/2400 [03:16<18:57,  1.89it/s] 11%|█         | 255/2400 [03:19<21:09,  1.69it/s] 11%|█         | 257/2400 [03:19<18:17,  1.95it/s] 11%|█         | 258/2400 [03:21<25:48,  1.38it/s] 11%|█         | 260/2400 [03:22<25:10,  1.42it/s] 11%|█         | 262/2400 [03:23<19:15,  1.85it/s] 11%|█         | 263/2400 [03:24<22:57,  1.55it/s] 11%|█         | 266/2400 [03:24<15:20,  2.32it/s] 11%|█         | 269/2400 [03:26<15:01,  2.36it/s] 11%|█▏        | 270/2400 [03:26<14:22,  2.47it/s] 11%|█▏        | 273/2400 [03:26<10:50,  3.27it/s] 12%|█▏        | 276/2400 [03:28<12:57,  2.73it/s] 12%|█▏        | 285/2400 [03:28<05:18,  6.64it/s] 12%|█▏        | 288/2400 [03:28<04:58,  7.08it/s] 12%|█▏        | 291/2400 [03:34<19:25,  1.81it/s] 12%|█▏        | 293/2400 [03:35<20:21,  1.72it/s] 12%|█▏        | 296/2400 [03:38<23:01,  1.52it/s] 12%|█▏        | 297/2400 [03:39<26:05,  1.34it/s] 12%|█▏        | 299/2400 [03:39<20:08,  1.74it/s] 13%|█▎        | 301/2400 [03:39<16:07,  2.17it/s] 13%|█▎        | 304/2400 [03:41<15:01,  2.32it/s] 13%|█▎        | 307/2400 [03:42<14:30,  2.41it/s] 13%|█▎        | 311/2400 [03:42<09:51,  3.53it/s] 13%|█▎        | 314/2400 [03:44<11:55,  2.92it/s] 13%|█▎        | 316/2400 [03:45<15:06,  2.30it/s] 13%|█▎        | 317/2400 [03:46<15:57,  2.18it/s] 13%|█▎        | 318/2400 [03:50<36:16,  1.05s/it] 13%|█▎        | 320/2400 [03:52<36:23,  1.05s/it] 13%|█▎        | 321/2400 [03:52<33:52,  1.02it/s] 13%|█▎        | 322/2400 [03:53<31:14,  1.11it/s] 14%|█▎        | 325/2400 [03:54<20:21,  1.70it/s] 14%|█▎        | 328/2400 [03:55<17:43,  1.95it/s] 14%|█▎        | 329/2400 [03:55<16:30,  2.09it/s] 14%|█▍        | 330/2400 [03:56<16:24,  2.10it/s] 14%|█▍        | 331/2400 [03:57<19:18,  1.79it/s] 14%|█▍        | 332/2400 [03:57<17:59,  1.92it/s] 14%|█▍        | 333/2400 [03:57<15:46,  2.18it/s] 14%|█▍        | 334/2400 [03:58<13:45,  2.50it/s] 14%|█▍        | 336/2400 [03:58<10:37,  3.24it/s] 14%|█▍        | 338/2400 [03:59<12:02,  2.85it/s] 14%|█▍        | 339/2400 [03:59<11:30,  2.99it/s] 14%|█▍        | 341/2400 [04:01<22:06,  1.55it/s] 14%|█▍        | 343/2400 [04:02<19:14,  1.78it/s] 14%|█▍        | 344/2400 [04:02<17:26,  1.96it/s] 15%|█▍        | 349/2400 [04:06<19:54,  1.72it/s] 15%|█▍        | 351/2400 [04:06<17:32,  1.95it/s] 15%|█▍        | 354/2400 [04:10<24:37,  1.38it/s] 15%|█▍        | 356/2400 [04:13<34:14,  1.01s/it]