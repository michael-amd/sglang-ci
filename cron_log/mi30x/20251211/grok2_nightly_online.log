[nightly] ==========================================
[nightly] SGL Nightly Benchmark Started
[nightly] ==========================================
[nightly] Command: scripts/perf_nightly.sh --model=grok2 --model-path=/data/models/grok-2 --tokenizer-path=/data/models/alvarobartt--grok-2-tokenizer --mode=online --hardware=mi30x --teams-webhook-url=
[nightly] Start time: 2025-12-11 13:30:01 PST
[nightly] Machine: dell300x-pla-t12-38
[nightly] Working directory: /mnt/raid/michael/sglang-ci
[nightly] Script location: /mnt/raid/michael/sglang-ci/scripts/perf_nightly.sh
[nightly] Process ID: 1512717
[nightly] ==========================================

[nightly] Runtime Environment:
[nightly] User: amd | Groups: amd adm cdrom... | Docker: /usr/bin/docker
[nightly] Testing Docker daemon access...
[nightly] Docker daemon accessible - proceeding...
[nightly] WARN: --teams-webhook-url was provided without a value - notifications disabled
[nightly] Custom model path provided: /data/models/grok-2
[nightly] Custom tokenizer path provided: /data/models/alvarobartt--grok-2-tokenizer
[nightly] Using rocm700 for grok2 on mi30x hardware
[nightly] Hardware: mi30x, ROCM Version: rocm700
[nightly] Model: grok2, Mode(s): online
[nightly] Created process lock: /tmp/perf_nightly_grok2.lock
[nightly] GPU is busy. Attempting to stop running Docker containers...
[nightly] No running containers to stop.
[nightly] Waiting 15s for GPU to become idle...
[nightly] WARN: GPU may still be busy, but proceeding as requested.
[nightly] Searching for non-SRT images for grok2 for the last 1 days...
[nightly] Searching for non-SRT mi30x image (rocm700) in 'rocm/sgl-dev' for date 20251211...
[nightly] Found candidate tag for day -0: v0.5.6.post1-rocm700-mi30x-20251211
[nightly] Pull attempt 1/3 for rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211...
v0.5.6.post1-rocm700-mi30x-20251211: Pulling from rocm/sgl-dev
660ffc76f83b: Pulling fs layer
8f15127cc838: Pulling fs layer
9b15895e3240: Pulling fs layer
f9b093ef803e: Pulling fs layer
7871d920fb0f: Pulling fs layer
7935d8c4e26c: Pulling fs layer
a32765e78010: Pulling fs layer
7fc751a2ed3a: Pulling fs layer
980be016a223: Pulling fs layer
f9b093ef803e: Waiting
9e1a971876ec: Pulling fs layer
ec6812b374e9: Pulling fs layer
a32765e78010: Waiting
01b887f14943: Pulling fs layer
844c30750327: Pulling fs layer
7871d920fb0f: Waiting
7fc751a2ed3a: Waiting
2682f0d8340c: Pulling fs layer
9e1a971876ec: Waiting
980be016a223: Waiting
7935d8c4e26c: Waiting
ec6812b374e9: Waiting
4f4fb700ef54: Pulling fs layer
01b887f14943: Waiting
844c30750327: Waiting
2682f0d8340c: Waiting
349b8c8a8418: Pulling fs layer
d0b1657b26f5: Pulling fs layer
4f4fb700ef54: Waiting
349b8c8a8418: Waiting
45b70560bebf: Pulling fs layer
d0b1657b26f5: Waiting
b18067367790: Pulling fs layer
45b70560bebf: Waiting
80e4388c8594: Pulling fs layer
43bd5f89e157: Pulling fs layer
b18067367790: Waiting
4f4e25c713a5: Pulling fs layer
80e4388c8594: Waiting
fa9b244e8ec3: Pulling fs layer
43bd5f89e157: Waiting
4f4e25c713a5: Waiting
fa9b244e8ec3: Waiting
802ff7b676ec: Pulling fs layer
91c970c997c5: Pulling fs layer
c7b1c2221fca: Pulling fs layer
f741376ff6a1: Pulling fs layer
d9b88c1e947d: Pulling fs layer
802ff7b676ec: Waiting
0e6681539f16: Pulling fs layer
91c970c997c5: Waiting
c7b1c2221fca: Waiting
f741376ff6a1: Waiting
6a588d14a733: Pulling fs layer
d9b88c1e947d: Waiting
0e6681539f16: Waiting
c4047ddad202: Pulling fs layer
6a588d14a733: Waiting
c4047ddad202: Waiting
d8b7caf6b6be: Pulling fs layer
51e84a0a21a8: Pulling fs layer
4d50178aaaf7: Pulling fs layer
228bf33f07ec: Pulling fs layer
4d50178aaaf7: Waiting
687c8acfabbd: Pulling fs layer
51e84a0a21a8: Waiting
228bf33f07ec: Waiting
0d311baf3b3e: Pulling fs layer
d8b7caf6b6be: Waiting
be0ac0064cd0: Pulling fs layer
687c8acfabbd: Waiting
0d311baf3b3e: Waiting
1b83604b328f: Pulling fs layer
1fecc6023f10: Pulling fs layer
be0ac0064cd0: Waiting
3191d42de5bf: Pulling fs layer
1b83604b328f: Waiting
d8f90ac21c04: Pulling fs layer
3191d42de5bf: Waiting
1fecc6023f10: Waiting
d8f90ac21c04: Waiting
0193b350796e: Pulling fs layer
b971d598c49f: Pulling fs layer
0193b350796e: Waiting
b971d598c49f: Waiting
8f15127cc838: Verifying Checksum
8f15127cc838: Download complete
660ffc76f83b: Verifying Checksum
660ffc76f83b: Download complete
7871d920fb0f: Verifying Checksum
7871d920fb0f: Download complete
660ffc76f83b: Pull complete
8f15127cc838: Pull complete
9b15895e3240: Verifying Checksum
9b15895e3240: Download complete
a32765e78010: Verifying Checksum
a32765e78010: Download complete
7fc751a2ed3a: Verifying Checksum
7fc751a2ed3a: Download complete
f9b093ef803e: Verifying Checksum
f9b093ef803e: Download complete
9e1a971876ec: Download complete
9b15895e3240: Pull complete
f9b093ef803e: Pull complete
7871d920fb0f: Pull complete
ec6812b374e9: Verifying Checksum
ec6812b374e9: Download complete
01b887f14943: Verifying Checksum
01b887f14943: Download complete
844c30750327: Verifying Checksum
844c30750327: Download complete
2682f0d8340c: Verifying Checksum
2682f0d8340c: Download complete
4f4fb700ef54: Verifying Checksum
4f4fb700ef54: Download complete
349b8c8a8418: Verifying Checksum
349b8c8a8418: Download complete
d0b1657b26f5: Verifying Checksum
d0b1657b26f5: Download complete
45b70560bebf: Verifying Checksum
45b70560bebf: Download complete
980be016a223: Verifying Checksum
980be016a223: Download complete
80e4388c8594: Download complete
7935d8c4e26c: Verifying Checksum
7935d8c4e26c: Download complete
4f4e25c713a5: Verifying Checksum
4f4e25c713a5: Download complete
fa9b244e8ec3: Download complete
802ff7b676ec: Verifying Checksum
802ff7b676ec: Download complete
43bd5f89e157: Verifying Checksum
43bd5f89e157: Download complete
91c970c997c5: Verifying Checksum
91c970c997c5: Download complete
f741376ff6a1: Verifying Checksum
f741376ff6a1: Download complete
d9b88c1e947d: Verifying Checksum
d9b88c1e947d: Download complete
0e6681539f16: Verifying Checksum
0e6681539f16: Download complete
6a588d14a733: Verifying Checksum
6a588d14a733: Download complete
c4047ddad202: Verifying Checksum
c4047ddad202: Download complete
d8b7caf6b6be: Download complete
51e84a0a21a8: Verifying Checksum
51e84a0a21a8: Download complete
b18067367790: Verifying Checksum
b18067367790: Download complete
4d50178aaaf7: Verifying Checksum
4d50178aaaf7: Download complete
687c8acfabbd: Verifying Checksum
687c8acfabbd: Download complete
c7b1c2221fca: Verifying Checksum
c7b1c2221fca: Download complete
be0ac0064cd0: Verifying Checksum
be0ac0064cd0: Download complete
1b83604b328f: Download complete
0d311baf3b3e: Verifying Checksum
0d311baf3b3e: Download complete
1fecc6023f10: Verifying Checksum
1fecc6023f10: Download complete
d8f90ac21c04: Verifying Checksum
d8f90ac21c04: Download complete
0193b350796e: Verifying Checksum
0193b350796e: Download complete
b971d598c49f: Verifying Checksum
b971d598c49f: Download complete
228bf33f07ec: Verifying Checksum
228bf33f07ec: Download complete
3191d42de5bf: Verifying Checksum
3191d42de5bf: Download complete
7935d8c4e26c: Pull complete
a32765e78010: Pull complete
7fc751a2ed3a: Pull complete
980be016a223: Pull complete
9e1a971876ec: Pull complete
ec6812b374e9: Pull complete
01b887f14943: Pull complete
844c30750327: Pull complete
2682f0d8340c: Pull complete
4f4fb700ef54: Pull complete
349b8c8a8418: Pull complete
d0b1657b26f5: Pull complete
45b70560bebf: Pull complete
b18067367790: Pull complete
80e4388c8594: Pull complete
43bd5f89e157: Pull complete
4f4e25c713a5: Pull complete
fa9b244e8ec3: Pull complete
802ff7b676ec: Pull complete
91c970c997c5: Pull complete
c7b1c2221fca: Pull complete
f741376ff6a1: Pull complete
d9b88c1e947d: Pull complete
0e6681539f16: Pull complete
6a588d14a733: Pull complete
c4047ddad202: Pull complete
d8b7caf6b6be: Pull complete
51e84a0a21a8: Pull complete
4d50178aaaf7: Pull complete
228bf33f07ec: Pull complete
687c8acfabbd: Pull complete
0d311baf3b3e: Pull complete
be0ac0064cd0: Pull complete
1b83604b328f: Pull complete
1fecc6023f10: Pull complete
3191d42de5bf: Pull complete
d8f90ac21c04: Pull complete
0193b350796e: Pull complete
b971d598c49f: Pull complete
Digest: sha256:283b79fed3330bc4a1bb1433da824aab110f6226e0c24e56158ee07c63b89bf7
Status: Downloaded newer image for rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211
docker.io/rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211
[nightly] Successfully pulled image: rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211
[nightly] Successfully obtained image for date 20251211: rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211
[nightly] Found 1 valid image(s) to run benchmarks on:
[nightly]   - rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211

[nightly] ==========================================
[nightly] Starting benchmarks for image: rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211
[nightly] ==========================================
[nightly] Checking GPU status before starting benchmarks for rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211...
[nightly] GPU is busy. Attempting to stop running Docker containers...
[nightly] No running containers to stop.
[nightly] Waiting 15s for GPU to become idle...
[nightly] WARN: GPU may still be busy, but proceeding as requested.
[nightly] INFO: Found 0/15 completed runs for rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211 (online). Proceeding with benchmarks.
[nightly] Using Docker image: rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211
[nightly] Container name: sgl-dev_v0.5.6.post1-rocm700-mi30x-20251211
[nightly] Creating container sgl-dev_v0.5.6.post1-rocm700-mi30x-20251211
[nightly] Custom model path /data/models/grok-2 requires mounting /data...
35edf89b85da0a240429994c994b12c8deeec8ac487487c6b11c61ff797a27a0
[nightly] === Starting benchmark execution ===
[nightly] === Starting nightly GROK2 online benchmark ===
[nightly] Launching grok_perf_online_csv.sh inside sgl-dev_v0.5.6.post1-rocm700-mi30x-20251211
[nightly] Adding --model-type=grok2 flag for Grok 2 benchmark
[nightly] Adding --tokenizer='/data/models/alvarobartt--grok-2-tokenizer' flag for Grok 2 benchmark
[online] Using Grok 2 configuration
[online] Using default Grok 2 tokenizer: /data/models/alvarobartt--grok-2-tokenizer
[online] Script started at: 2025-12-11 13:36:42 PST
Scanning existing logs to check if all benchmarks are already complete...
Checking GSM8K log status...
Missing: GSM8K log file (/mnt/raid/michael/sglang-ci/online/GROK2/v0.5.6.post1-rocm700-mi30x-20251211_GROK2_FP8_online/sglang_client_log_GROK2_gsm8k_aiter.log)
Checking client benchmark logs...
Scan complete: 0/5 client benchmark runs are complete.
❌ Missing or incomplete client benchmark runs.
❌ GSM8K benchmark is missing, empty, or incomplete.
Server startup required.
Starting benchmarks using aiter backend...
[online] Cleaning up stale aiter JIT lock files...
[online] No stale aiter lock files found
[online] Using Grok2 environment: HSA_ENABLE_COREDUMP=0 RCCL_MSCCL_ENABLE=0 SGLANG_USE_AITER=1 SGLANG_INT4_WEIGHT=0
[online] Launching backend=aiter for grok2
[online] Waiting for server to be ready (timeout: 600s)...
[online] Still waiting... (10s elapsed)
[online] Still waiting... (20s elapsed)
[online] Still waiting... (30s elapsed)
[online] Still waiting... (40s elapsed)
[online] Still waiting... (50s elapsed)
[online] Still waiting... (60s elapsed)
[online] Still waiting... (70s elapsed)
[online] Still waiting... (80s elapsed)
[online] Still waiting... (90s elapsed)
[online] Still waiting... (100s elapsed)
[online] Still waiting... (110s elapsed)
[online] Still waiting... (120s elapsed)
[online] Still waiting... (130s elapsed)
[online] Still waiting... (140s elapsed)
[online] Still waiting... (150s elapsed)
[online] Still waiting... (160s elapsed)
[online] Still waiting... (170s elapsed)
[online] Still waiting... (180s elapsed)
[online] Still waiting... (190s elapsed)
[online] Still waiting... (200s elapsed)
[online] Still waiting... (210s elapsed)
[online] Still waiting... (220s elapsed)
[online] Still waiting... (230s elapsed)
[online] Still waiting... (240s elapsed)
[online] Still waiting... (250s elapsed)
[online] Still waiting... (260s elapsed)
[online] Still waiting... (270s elapsed)
[online] Still waiting... (280s elapsed)
[online] Still waiting... (290s elapsed)
[online] Still waiting... (300s elapsed)
[online] Still waiting... (310s elapsed)
[online] Still waiting... (320s elapsed)
[online] Still waiting... (330s elapsed)
[online] Still waiting... (340s elapsed)
[online] Still waiting... (350s elapsed)
[online] Still waiting... (360s elapsed)
[online] Still waiting... (370s elapsed)
[online] Still waiting... (380s elapsed)
[online] Still waiting... (390s elapsed)
[online] Still waiting... (400s elapsed)
[online] Still waiting... (410s elapsed)
[online] Still waiting... (420s elapsed)
[online] Still waiting... (430s elapsed)
[online] Still waiting... (440s elapsed)
[online] Still waiting... (450s elapsed)
[online] Still waiting... (460s elapsed)
[online] Still waiting... (470s elapsed)
[online] Still waiting... (480s elapsed)
[online] Still waiting... (490s elapsed)
[online] Still waiting... (500s elapsed)
[online] Still waiting... (510s elapsed)
[online] Still waiting... (520s elapsed)
[online] Still waiting... (530s elapsed)
[online] Still waiting... (540s elapsed)
[online] Still waiting... (550s elapsed)
[online] Still waiting... (560s elapsed)
[online] Still waiting... (570s elapsed)
[online] Still waiting... (580s elapsed)
[online] Still waiting... (590s elapsed)
[online] ERROR: Server failed to start within 600 seconds
[online] Last 50 lines of server log:
[aiter] import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
[2025-12-11 13:36:49] INFO core.py:477: import [module_aiter_enum] under /sgl-workspace/aiter/aiter/jit/module_aiter_enum.so
INFO 12-11 13:36:50 [__init__.py:241] Automatically detected platform rocm.
/sgl-workspace/sglang/python/sglang/srt/layers/quantization/awq.py:71: UserWarning: HIP does not support fused_marlin_moe currently.
  warnings.warn(f"HIP does not support fused_marlin_moe currently.")
/sgl-workspace/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
Traceback (most recent call last):
  File "/opt/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1360, in from_pretrained
    config_class = CONFIG_MAPPING[config_dict["model_type"]]
  File "/opt/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1048, in __getitem__
    raise KeyError(key)
KeyError: 'grok'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/sgl-workspace/sglang/python/sglang/launch_server.py", line 25, in <module>
    server_args = prepare_server_args(sys.argv[1:])
  File "/sgl-workspace/sglang/python/sglang/srt/server_args.py", line 4494, in prepare_server_args
    return ServerArgs.from_cli_args(raw_args)
  File "/sgl-workspace/sglang/python/sglang/srt/server_args.py", line 4032, in from_cli_args
    return cls(**{attr: getattr(args, attr) for attr in attrs})
  File "<string>", line 294, in __init__
  File "/sgl-workspace/sglang/python/sglang/srt/server_args.py", line 646, in __post_init__
    self._handle_model_specific_adjustments()
  File "/sgl-workspace/sglang/python/sglang/srt/server_args.py", line 978, in _handle_model_specific_adjustments
    hf_config = self.get_hf_config()
  File "/sgl-workspace/sglang/python/sglang/srt/server_args.py", line 4042, in get_hf_config
    hf_config = get_config(
  File "/sgl-workspace/sglang/python/sglang/srt/utils/common.py", line 3206, in wrapper
    result = func(*args, **kwargs)
  File "/sgl-workspace/sglang/python/sglang/srt/utils/hf_transformers_utils.py", line 267, in get_config
    raise e
  File "/sgl-workspace/sglang/python/sglang/srt/utils/hf_transformers_utils.py", line 262, in get_config
    config = AutoConfig.from_pretrained(
  File "/opt/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1362, in from_pretrained
    raise ValueError(
ValueError: The checkpoint you are trying to load has model type `grok` but Transformers does not recognize this architecture. This could be because of an issue with the checkpoint, or because your version of Transformers is out of date.

You can update Transformers with the command `pip install --upgrade transformers`. If this does not work, and the checkpoint is very new, then there may not be a release version that supports this model yet. In this case, you can get the most up-to-date code by installing Transformers from source with the command `pip install git+https://github.com/huggingface/transformers.git`
[nightly] === Online benchmark dispatched for GROK2; check logs in sgl-dev_v0.5.6.post1-rocm700-mi30x-20251211 ===
[nightly] === Starting post-processing (CSV processing, plot generation, Teams notifications) ===
[nightly] Processing online CSV data and generating plots... Logs will be saved to /mnt/raid/michael/sglang-ci/online/GROK2/v0.5.6.post1-rocm700-mi30x-20251211_GROK2_FP8_online/process_and_generate_online_plots.log
[nightly] Using plot date from image tag: 20251211
[nightly] ERROR: Online post-processing failed (exit code: 1)
[nightly] Error notification skipped - no webhook URL configured
[nightly] ==========================================
[nightly] Completed benchmarks for image: rocm/sgl-dev:v0.5.6.post1-rocm700-mi30x-20251211
[nightly] Stopping container sgl-dev_v0.5.6.post1-rocm700-mi30x-20251211 to release resources...
[nightly] ==========================================
[nightly] ==========================================
[nightly] All benchmarks completed for 1 image(s)
[nightly] ==========================================
[nightly] Cleaning up process lock...
