[nightly] ==========================================
[nightly] SGL Nightly Benchmark Started
[nightly] ==========================================
[nightly] Command: scripts/perf_nightly.sh --model=grok2 --model-path=/data/models/grok-2 --tokenizer-path=/data/models/alvarobartt--grok-2-tokenizer --mode=online --hardware=mi30x --teams-webhook-url=https://default3dd8961fe4884e608e11a82d994e18.3d.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/c8c6cfd045c8452a8df5f8922ab5e540/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=hsr-c64Xxhev7ECv6rchSO1bQswM-cNEc5895jX5JpQ
[nightly] Start time: 2025-12-03 07:30:01 PST
[nightly] Machine: dell300x-pla-t12-38
[nightly] Working directory: /mnt/raid/michael/sglang-ci
[nightly] Script location: /mnt/raid/michael/sglang-ci/scripts/perf_nightly.sh
[nightly] Process ID: 3468831
[nightly] ==========================================

[nightly] Runtime Environment:
[nightly] User: amd | Groups: amd adm cdrom... | Docker: /usr/bin/docker
[nightly] Testing Docker daemon access...
[nightly] Docker daemon accessible - proceeding...
[nightly] Teams webhook URL provided via command line - notifications enabled
[nightly] Custom model path provided: /data/models/grok-2
[nightly] Custom tokenizer path provided: /data/models/alvarobartt--grok-2-tokenizer
[nightly] Using rocm700 for grok2 on mi30x hardware
[nightly] Hardware: mi30x, ROCM Version: rocm700
[nightly] Model: grok2, Mode(s): online
[nightly] Created process lock: /tmp/perf_nightly_grok2.lock
[nightly] GPU is busy. Attempting to stop running Docker containers...
[nightly] Stopping running containers: 649744c50c30
[nightly] Waiting 15s for GPU to become idle...
[nightly] WARN: GPU may still be busy, but proceeding as requested.
[nightly] Searching for non-SRT images for grok2 for the last 1 days...
[nightly] Searching for non-SRT mi30x image (rocm700) in 'rocm/sgl-dev' for date 20251203...
[nightly] Found candidate tag for day -0: v0.5.6-rocm700-mi30x-20251203
[nightly] Pull attempt 1/3 for rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203...
v0.5.6-rocm700-mi30x-20251203: Pulling from rocm/sgl-dev
660ffc76f83b: Already exists
8f15127cc838: Already exists
9b15895e3240: Already exists
f9b093ef803e: Already exists
7871d920fb0f: Already exists
7935d8c4e26c: Already exists
a32765e78010: Already exists
7fc751a2ed3a: Already exists
980be016a223: Already exists
9e1a971876ec: Already exists
ec6812b374e9: Already exists
01b887f14943: Already exists
844c30750327: Already exists
2682f0d8340c: Already exists
4f4fb700ef54: Already exists
349b8c8a8418: Already exists
d0b1657b26f5: Already exists
45b70560bebf: Already exists
4f4fb700ef54: Already exists
b18067367790: Already exists
80e4388c8594: Already exists
43bd5f89e157: Already exists
4f4e25c713a5: Already exists
fa9b244e8ec3: Already exists
4f4fb700ef54: Already exists
4f4fb700ef54: Already exists
802ff7b676ec: Already exists
4f4fb700ef54: Already exists
91c970c997c5: Already exists
c7b1c2221fca: Already exists
f741376ff6a1: Already exists
d9b88c1e947d: Already exists
0e6681539f16: Already exists
66a98f12effc: Pulling fs layer
4f4fb700ef54: Pulling fs layer
39e0c71240e7: Pulling fs layer
bd8853b3f699: Pulling fs layer
fb774eb41123: Pulling fs layer
24c544eed16f: Pulling fs layer
aec9ffc483f7: Pulling fs layer
1c5d20caf3fd: Pulling fs layer
fb774eb41123: Waiting
a0f2cc5b9040: Pulling fs layer
aec9ffc483f7: Waiting
24c544eed16f: Waiting
4ebbca8b7faf: Pulling fs layer
bd8853b3f699: Waiting
1c5d20caf3fd: Waiting
ff2ef5003a62: Pulling fs layer
a0f2cc5b9040: Waiting
4ebbca8b7faf: Waiting
15c77e1530c5: Pulling fs layer
ff2ef5003a62: Waiting
24e04dd9616a: Pulling fs layer
15c77e1530c5: Waiting
1d9c0a7628c3: Pulling fs layer
24e04dd9616a: Waiting
e78c324cfe4e: Pulling fs layer
38d3d1e1af4b: Pulling fs layer
1d9c0a7628c3: Waiting
e78c324cfe4e: Waiting
38d3d1e1af4b: Waiting
4f4fb700ef54: Download complete
39e0c71240e7: Verifying Checksum
39e0c71240e7: Download complete
bd8853b3f699: Verifying Checksum
bd8853b3f699: Download complete
66a98f12effc: Verifying Checksum
66a98f12effc: Download complete
66a98f12effc: Pull complete
4f4fb700ef54: Pull complete
39e0c71240e7: Pull complete
bd8853b3f699: Pull complete
fb774eb41123: Verifying Checksum
fb774eb41123: Download complete
1c5d20caf3fd: Verifying Checksum
fb774eb41123: Pull complete
24c544eed16f: Verifying Checksum
24c544eed16f: Download complete
4ebbca8b7faf: Verifying Checksum
4ebbca8b7faf: Download complete
ff2ef5003a62: Verifying Checksum
ff2ef5003a62: Download complete
a0f2cc5b9040: Verifying Checksum
a0f2cc5b9040: Download complete
15c77e1530c5: Verifying Checksum
15c77e1530c5: Download complete
1d9c0a7628c3: Verifying Checksum
1d9c0a7628c3: Download complete
e78c324cfe4e: Verifying Checksum
e78c324cfe4e: Download complete
38d3d1e1af4b: Verifying Checksum
38d3d1e1af4b: Download complete
24c544eed16f: Pull complete
aec9ffc483f7: Verifying Checksum
aec9ffc483f7: Download complete
aec9ffc483f7: Pull complete
1c5d20caf3fd: Pull complete
a0f2cc5b9040: Pull complete
4ebbca8b7faf: Pull complete
ff2ef5003a62: Pull complete
15c77e1530c5: Pull complete
24e04dd9616a: Verifying Checksum
24e04dd9616a: Download complete
24e04dd9616a: Pull complete
1d9c0a7628c3: Pull complete
e78c324cfe4e: Pull complete
38d3d1e1af4b: Pull complete
Digest: sha256:3bc5538b208640802b275a3601f3042f683a761e183ee79a3ff6356f5d4e4412
Status: Downloaded newer image for rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203
docker.io/rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203
[nightly] Successfully pulled image: rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203
[nightly] Successfully obtained image for date 20251203: rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203
[nightly] Found 1 valid image(s) to run benchmarks on:
[nightly]   - rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203

[nightly] ==========================================
[nightly] Starting benchmarks for image: rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203
[nightly] ==========================================
[nightly] Checking GPU status before starting benchmarks for rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203...
[nightly] GPU is busy. Attempting to stop running Docker containers...
[nightly] No running containers to stop.
[nightly] Waiting 15s for GPU to become idle...
[nightly] WARN: GPU may still be busy, but proceeding as requested.
[nightly] INFO: Found 0/15 completed runs for rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203 (online). Proceeding with benchmarks.
[nightly] Using Docker image: rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203
[nightly] Container name: sgl-dev_v0.5.6-rocm700-mi30x-20251203
[nightly] Creating container sgl-dev_v0.5.6-rocm700-mi30x-20251203
[nightly] Custom model path /data/models/grok-2 requires mounting /data...
f753fe510b2e66f7e3abf7e7b7310724bcea37524f5a9009f3a7eb8a61289d32
[nightly] === Starting benchmark execution ===
[nightly] === Starting nightly GROK2 online benchmark ===
[nightly] Launching grok_perf_online_csv.sh inside sgl-dev_v0.5.6-rocm700-mi30x-20251203
[nightly] Adding --model-type=grok2 flag for Grok 2 benchmark
[nightly] Adding --tokenizer='/data/models/alvarobartt--grok-2-tokenizer' flag for Grok 2 benchmark
[online] Using Grok 2 configuration
[online] Using default Grok 2 tokenizer: /data/models/alvarobartt--grok-2-tokenizer
[online] Script started at: 2025-12-03 07:32:41 PST
Scanning existing logs to check if all benchmarks are already complete...
Checking GSM8K log status...
Missing: GSM8K log file (/mnt/raid/michael/sglang-ci/online/GROK2/v0.5.6-rocm700-mi30x-20251203_GROK2_FP8_online/sglang_client_log_GROK2_gsm8k_aiter.log)
Checking client benchmark logs...
Scan complete: 0/5 client benchmark runs are complete.
❌ Missing or incomplete client benchmark runs.
❌ GSM8K benchmark is missing, empty, or incomplete.
Server startup required.
Starting benchmarks using aiter backend...
[online] Using Grok2 environment: RCCL_MSCCL_ENABLE=0 SGLANG_USE_AITER=1 SGLANG_INT4_WEIGHT=0
[online] Launching backend=aiter for grok2
[online] Waiting for server to be ready (timeout: 600s)...
[online] Still waiting... (10s elapsed)
[online] Still waiting... (20s elapsed)
[online] Still waiting... (30s elapsed)
[online] Still waiting... (40s elapsed)
[online] Still waiting... (50s elapsed)
[online] Still waiting... (60s elapsed)
[online] Still waiting... (70s elapsed)
[online] Still waiting... (80s elapsed)
[online] Still waiting... (90s elapsed)
[online] Still waiting... (100s elapsed)
[online] Still waiting... (110s elapsed)
[online] Still waiting... (120s elapsed)
[online] Still waiting... (130s elapsed)
[online] Still waiting... (140s elapsed)
[online] Still waiting... (150s elapsed)
[online] Still waiting... (160s elapsed)
[online] Still waiting... (170s elapsed)
[online] Still waiting... (180s elapsed)
[online] Still waiting... (190s elapsed)
[online] Still waiting... (200s elapsed)
[online] Still waiting... (210s elapsed)
[online] Still waiting... (220s elapsed)
[online] Still waiting... (230s elapsed)
[online] Still waiting... (240s elapsed)
[online] Still waiting... (250s elapsed)
[online] Still waiting... (260s elapsed)
[online] Still waiting... (270s elapsed)
[online] Still waiting... (280s elapsed)
[online] Still waiting... (290s elapsed)
[online] Still waiting... (300s elapsed)
[online] Still waiting... (310s elapsed)
[online] Still waiting... (320s elapsed)
[online] Still waiting... (330s elapsed)
[online] Still waiting... (340s elapsed)
[online] Still waiting... (350s elapsed)
[online] Still waiting... (360s elapsed)
[online] Still waiting... (370s elapsed)
[online] Still waiting... (380s elapsed)
[online] Still waiting... (390s elapsed)
[online] Still waiting... (400s elapsed)
[online] Still waiting... (410s elapsed)
[online] Still waiting... (420s elapsed)
[online] Still waiting... (430s elapsed)
[online] Still waiting... (440s elapsed)
[online] Still waiting... (450s elapsed)
[online] Still waiting... (460s elapsed)
[online] Still waiting... (470s elapsed)
[online] Still waiting... (480s elapsed)
[online] Still waiting... (490s elapsed)
[online] Still waiting... (500s elapsed)
[online] Still waiting... (510s elapsed)
[online] Still waiting... (520s elapsed)
[online] Still waiting... (530s elapsed)
[online] Still waiting... (540s elapsed)
[online] Still waiting... (550s elapsed)
[online] Still waiting... (560s elapsed)
[online] Still waiting... (570s elapsed)
[online] Still waiting... (580s elapsed)
[online] Still waiting... (590s elapsed)
[online] ERROR: Server failed to start within 600 seconds
[online] Last 50 lines of server log:
merge tuned file under model_configs/ and configs/  /sgl-workspace/aiter/aiter/configs/a8w8_blockscale_tuned_gemm.csv:/sgl-workspace/aiter/aiter/configs/model_configs/a8w8_blockscale_tuned_gemm_ds_v3.csv
merge tuned file under model_configs/ and configs/  /sgl-workspace/aiter/aiter/configs/a8w8_blockscale_bpreshuffle_tuned_gemm.csv:/sgl-workspace/aiter/aiter/configs/model_configs/a8w8_blockscale_bpreshuffle_tuned_gemm_dsv3.csv
INFO 12-03 07:32:53 [__init__.py:241] Automatically detected platform rocm.
/sgl-workspace/sglang/python/sglang/srt/layers/quantization/awq.py:63: UserWarning: HIP does not support fused_marlin_moe currently.
  warnings.warn(f"HIP does not support fused_marlin_moe currently.")
/sgl-workspace/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
Traceback (most recent call last):
  File "/opt/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1360, in from_pretrained
    config_class = CONFIG_MAPPING[config_dict["model_type"]]
  File "/opt/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1048, in __getitem__
    raise KeyError(key)
KeyError: 'grok'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/sgl-workspace/sglang/python/sglang/launch_server.py", line 24, in <module>
    server_args = prepare_server_args(sys.argv[1:])
  File "/sgl-workspace/sglang/python/sglang/srt/server_args.py", line 4371, in prepare_server_args
    return ServerArgs.from_cli_args(raw_args)
  File "/sgl-workspace/sglang/python/sglang/srt/server_args.py", line 3924, in from_cli_args
    return cls(**{attr: getattr(args, attr) for attr in attrs})
  File "<string>", line 290, in __init__
  File "/sgl-workspace/sglang/python/sglang/srt/server_args.py", line 620, in __post_init__
    self._handle_model_specific_adjustments()
  File "/sgl-workspace/sglang/python/sglang/srt/server_args.py", line 937, in _handle_model_specific_adjustments
    hf_config = self.get_hf_config()
  File "/sgl-workspace/sglang/python/sglang/srt/server_args.py", line 3934, in get_hf_config
    hf_config = get_config(
  File "/sgl-workspace/sglang/python/sglang/srt/utils/common.py", line 3227, in wrapper
    result = func(*args, **kwargs)
  File "/sgl-workspace/sglang/python/sglang/srt/utils/hf_transformers_utils.py", line 225, in get_config
    raise e
  File "/sgl-workspace/sglang/python/sglang/srt/utils/hf_transformers_utils.py", line 219, in get_config
    config = AutoConfig.from_pretrained(
  File "/opt/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1362, in from_pretrained
    raise ValueError(
ValueError: The checkpoint you are trying to load has model type `grok` but Transformers does not recognize this architecture. This could be because of an issue with the checkpoint, or because your version of Transformers is out of date.

You can update Transformers with the command `pip install --upgrade transformers`. If this does not work, and the checkpoint is very new, then there may not be a release version that supports this model yet. In this case, you can get the most up-to-date code by installing Transformers from source with the command `pip install git+https://github.com/huggingface/transformers.git`
[nightly] === Online benchmark dispatched for GROK2; check logs in sgl-dev_v0.5.6-rocm700-mi30x-20251203 ===
[nightly] === Starting post-processing (CSV processing, plot generation, Teams notifications) ===
[nightly] Processing online CSV data and generating plots... Logs will be saved to /mnt/raid/michael/sglang-ci/online/GROK2/v0.5.6-rocm700-mi30x-20251203_GROK2_FP8_online/process_and_generate_online_plots.log
[nightly] Using plot date from image tag: 20251203
[nightly] ERROR: Online post-processing failed (exit code: 1)
[nightly] Sending error notification to Teams...
[nightly] WARN: Error notification failed (HTTP 202)
[nightly] ==========================================
[nightly] Completed benchmarks for image: rocm/sgl-dev:v0.5.6-rocm700-mi30x-20251203
[nightly] Stopping container sgl-dev_v0.5.6-rocm700-mi30x-20251203 to release resources...
[nightly] ==========================================
[nightly] ==========================================
[nightly] All benchmarks completed for 1 image(s)
[nightly] ==========================================
[nightly] Cleaning up process lock...
