[nightly] ==========================================
[nightly] SGL Nightly Benchmark Started
[nightly] ==========================================
[nightly] Command: perf_nightly.sh --model=grok --model-path=/mnt/raid/models/huggingface/amd--grok-1-W4A8KV8 --mode=online --hardware=mi30x --teams-webhook-url=https://default3dd8961fe4884e608e11a82d994e18.3d.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/2115793fe51a4371bcedd8ff67ff0418/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=hzr6aH40CKrySSK64uAnsmVIR8ynAkIRTH65z-wqxNA
[nightly] Start time: 2025-10-22 12:00:01 PDT
[nightly] Machine: dell300x-pla-t10-23
[nightly] Working directory: /mnt/raid/michael/sglang-ci
[nightly] Script location: /mnt/raid/michael/sglang-ci/perf_nightly.sh
[nightly] Process ID: 3997637
[nightly] ==========================================

[nightly] Runtime Environment:
[nightly] User: amd | Groups: amd video users... | Docker: /usr/bin/docker
[nightly] Testing Docker daemon access...
[nightly] Docker daemon accessible - proceeding...
[nightly] Teams webhook URL provided via command line - notifications enabled
[nightly] Custom model path provided: /mnt/raid/models/huggingface/amd--grok-1-W4A8KV8
[nightly] Hardware: mi30x, ROCM Version: rocm630
[nightly] Model: grok, Mode(s): online
[nightly] Created process lock: /tmp/perf_nightly_grok.lock
[nightly] GPU is busy. Attempting to stop running Docker containers...
[nightly] Stopping running containers: 7b5f12364afd
[nightly] Waiting 15s for GPU to become idle...
[nightly] WARN: GPU may still be busy, but proceeding as requested.
[nightly] Searching for non-SRT images for grok for the last 1 days...
[nightly] Searching for non-SRT mi30x image in 'rocm/sgl-dev' for date 20251022...
[nightly] Found candidate tag for day -0: v0.5.3.post3-rocm630-mi30x-20251022
[nightly] Found local image: rocm/sgl-dev:v0.5.3.post3-rocm630-mi30x-20251022
[nightly] Successfully obtained image for date 20251022: rocm/sgl-dev:v0.5.3.post3-rocm630-mi30x-20251022
[nightly] Found 1 valid image(s) to run benchmarks on:
[nightly]   - rocm/sgl-dev:v0.5.3.post3-rocm630-mi30x-20251022

[nightly] ==========================================
[nightly] Starting benchmarks for image: rocm/sgl-dev:v0.5.3.post3-rocm630-mi30x-20251022
[nightly] ==========================================
[nightly] Checking GPU status before starting benchmarks for rocm/sgl-dev:v0.5.3.post3-rocm630-mi30x-20251022...
[nightly] GPU is busy. Attempting to stop running Docker containers...
[nightly] Stopping running containers: 3af416ce6c33
[nightly] Waiting 15s for GPU to become idle...
[nightly] WARN: GPU may still be busy, but proceeding as requested.
[nightly] INFO: Found 0/15 completed runs for rocm/sgl-dev:v0.5.3.post3-rocm630-mi30x-20251022 (online). Proceeding with benchmarks.
[nightly] Using Docker image: rocm/sgl-dev:v0.5.3.post3-rocm630-mi30x-20251022
[nightly] Container name: sgl-dev_v0.5.3.post3-rocm630-mi30x-20251022
[nightly] Reusing container sgl-dev_v0.5.3.post3-rocm630-mi30x-20251022
[nightly] === Starting benchmark execution ===
[nightly] === Starting nightly GROK online benchmark ===
[nightly] Launching grok_perf_online_csv.sh inside sgl-dev_v0.5.3.post3-rocm630-mi30x-20251022
[online] Auto-detected model type: grok1 from path: /mnt/raid/models/huggingface/amd--grok-1-W4A8KV8
[online] Using Grok 1 configuration
[online] Script started at: 2025-10-22 12:00:34 PDT
Scanning existing logs to check if all benchmarks are already complete...
Checking GSM8K log status...
Missing: GSM8K log file (/mnt/raid/michael/sglang-ci/online/GROK1/v0.5.3.post3-rocm630-mi30x-20251022_GROK1_MOE-I4F8_online/sglang_client_log_GROK1_gsm8k_aiter.log)
Checking client benchmark logs...
Scan complete: 0/15 client benchmark runs are complete.
❌ Missing or incomplete client benchmark runs.
❌ GSM8K benchmark is missing, empty, or incomplete.
Server startup required.
Starting benchmarks using aiter backend...
[online] Using Grok1 environment: SGLANG_USE_AITER=1 SGLANG_INT4_WEIGHT=1
[online] Launching backend=aiter for grok1
[online] Waiting for server to be ready (timeout: 600s)...
[online] Still waiting... (10s elapsed)
[online] Still waiting... (20s elapsed)
[online] Still waiting... (30s elapsed)
[online] Still waiting... (40s elapsed)
[online] Still waiting... (50s elapsed)
[online] Still waiting... (60s elapsed)
[online] Still waiting... (70s elapsed)
[online] Still waiting... (80s elapsed)
[online] Still waiting... (90s elapsed)
[online] Still waiting... (100s elapsed)
[online] Still waiting... (110s elapsed)
[online] Still waiting... (120s elapsed)
[online] Still waiting... (130s elapsed)
[online] Still waiting... (140s elapsed)
[online] Still waiting... (150s elapsed)
[online] Still waiting... (160s elapsed)
[online] Still waiting... (170s elapsed)
[online] Still waiting... (180s elapsed)
[online] Still waiting... (190s elapsed)
[online] Still waiting... (200s elapsed)
[online] Still waiting... (210s elapsed)
[online] Still waiting... (220s elapsed)
[online] Still waiting... (230s elapsed)
[online] Still waiting... (240s elapsed)
[online] Still waiting... (250s elapsed)
[online] Still waiting... (260s elapsed)
[online] Still waiting... (270s elapsed)
[online] Still waiting... (280s elapsed)
[online] Still waiting... (290s elapsed)
[online] Still waiting... (300s elapsed)
[online] Still waiting... (310s elapsed)
[online] Still waiting... (320s elapsed)
[online] Still waiting... (330s elapsed)
[online] Still waiting... (340s elapsed)
[online] Still waiting... (350s elapsed)
[online] Still waiting... (360s elapsed)
[online] Still waiting... (370s elapsed)
[online] Still waiting... (380s elapsed)
[online] Still waiting... (390s elapsed)
[online] Still waiting... (400s elapsed)
[online] Still waiting... (410s elapsed)
[online] Still waiting... (420s elapsed)
[online] Still waiting... (430s elapsed)
[online] Still waiting... (440s elapsed)
[online] Still waiting... (450s elapsed)
[online] Still waiting... (460s elapsed)
[online] Still waiting... (470s elapsed)
[online] Still waiting... (480s elapsed)
[online] Still waiting... (490s elapsed)
[online] Still waiting... (500s elapsed)
[online] Still waiting... (510s elapsed)
[online] Still waiting... (520s elapsed)
[online] Still waiting... (530s elapsed)
[online] Still waiting... (540s elapsed)
[online] Still waiting... (550s elapsed)
[online] Still waiting... (560s elapsed)
[online] Still waiting... (570s elapsed)
[online] Still waiting... (580s elapsed)
[online] Still waiting... (590s elapsed)
[online] ERROR: Server failed to start within 600 seconds
[online] Last 50 lines of server log:
[2025-10-22 12:00:54] INFO trace.py:48: opentelemetry package is not installed, tracing disabled
[2025-10-22 12:00:54] INFO trace.py:48: opentelemetry package is not installed, tracing disabled
[2025-10-22 12:00:54 TP7] Process 303 gpu_id 7 is running on CPUs: [84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95]
`torch_dtype` is deprecated! Use `dtype` instead!
[2025-10-22 12:00:54 TP2] Process 298 gpu_id 2 is running on CPUs: [24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]
`torch_dtype` is deprecated! Use `dtype` instead!
[2025-10-22 12:00:54] INFO trace.py:48: opentelemetry package is not installed, tracing disabled
[2025-10-22 12:00:54] INFO trace.py:48: opentelemetry package is not installed, tracing disabled
[2025-10-22 12:00:54] INFO trace.py:48: opentelemetry package is not installed, tracing disabled
[2025-10-22 12:00:54 TP4] Process 300 gpu_id 4 is running on CPUs: [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
`torch_dtype` is deprecated! Use `dtype` instead!
[2025-10-22 12:00:55 TP0] Process 296 gpu_id 0 is running on CPUs: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
`torch_dtype` is deprecated! Use `dtype` instead!
[2025-10-22 12:00:55 TP3] Process 299 gpu_id 3 is running on CPUs: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47]
`torch_dtype` is deprecated! Use `dtype` instead!
[2025-10-22 12:00:55 TP5] Init torch distributed begin.
[2025-10-22 12:00:55 TP7] Init torch distributed begin.
[2025-10-22 12:00:55 TP2] Init torch distributed begin.
[2025-10-22 12:00:55 TP4] Init torch distributed begin.
[2025-10-22 12:00:55 TP3] Init torch distributed begin.
[2025-10-22 12:00:55 TP0] Init torch distributed begin.
[2025-10-22 12:00:56 TP0] sglang is using nccl==2.21.5
Memory access fault by GPU node-6 (Agent handle: 0xa752b20) on address 0x7ebf07ec4000. Reason: Unknown.
Fatal Python error: Aborted

Thread 0x00007ef910d37640 (most recent call first):
  File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_worker/subproc_pool.py", line 55 in _recv_msg
  File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/compile_worker/subproc_pool.py", line 191 in _read_thread
  File "/usr/lib/python3.12/threading.py", line 1012 in run
  File "/usr/lib/python3.12/threading.py", line 1075 in _bootstrap_inner
  File "/usr/lib/python3.12/threading.py", line 1032 in _bootstrap

Thread 0x00007f3d95457480 (most recent call first):
  File "/sgl-workspace/sglang/python/sglang/srt/distributed/device_communicators/pynccl_wrapper.py", line 400 in ncclCommInitRank
  File "/sgl-workspace/sglang/python/sglang/srt/distributed/device_communicators/pynccl.py", line 112 in __init__
  File "/sgl-workspace/sglang/python/sglang/srt/distributed/parallel_state.py", line 326 in __init__
  File "/sgl-workspace/sglang/python/sglang/srt/distributed/parallel_state.py", line 1299 in init_model_parallel_group
  File "/sgl-workspace/sglang/python/sglang/srt/distributed/parallel_state.py", line 1532 in initialize_model_parallel
  File "/sgl-workspace/sglang/python/sglang/srt/model_executor/model_runner.py", line 773 in init_torch_distributed
  File "/sgl-workspace/sglang/python/sglang/srt/model_executor/model_runner.py", line 305 in __init__
  File "/sgl-workspace/sglang/python/sglang/srt/managers/tp_worker.py", line 229 in __init__
  File "/sgl-workspace/sglang/python/sglang/srt/managers/scheduler.py", line 305 in __init__
  File "/sgl-workspace/sglang/python/sglang/srt/managers/scheduler.py", line 2872 in run_scheduler_process
  File "/usr/lib/python3.12/multiprocessing/process.py", line 108 in run
  File "/usr/lib/python3.12/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/lib/python3.12/multiprocessing/spawn.py", line 135 in _main
  File "/usr/lib/python3.12/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy.core._multiarray_umath, numpy.core._multiarray_tests, numpy.linalg._umath_linalg, numpy.fft._pocketfft_internal, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._mt19937, numpy.random.mtrand, numpy.random._philox, numpy.random._pcg64, numpy.random._sfc64, numpy.random._generator, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, psutil._psutil_linux, psutil._psutil_posix, zmq.backend.cython._zmq, PIL._imaging, cython.cimports.libc.math, sentencepiece._sentencepiece, regex._regex, yaml._yaml, markupsafe._speedups, PIL._imagingft, hiredis.hiredis, _cffi_backend, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, _cyutility, scipy._cyutility, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpack, scipy.sparse.linalg._propack._spropack, scipy.sparse.linalg._propack._dpropack, scipy.sparse.linalg._propack._cpropack, scipy.sparse.linalg._propack._zpropack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation, scipy.spatial.transform._rigid_transform, scipy.optimize._direct, setproctitle, msgspec._core, vllm.utils, vllm.sampling_params, vllm.sequence, roctxMarker, vllm.model_executor.layers.sampler, vllm.core.scheduler, vllm.engine.output_processor.stop_checker, msgpack._cmsgpack, google._upb._message, uvloop.loop, ray._raylet, vllm.transformers_utils.detokenizer, vllm.outputs, vllm.engine.llm_engine, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, hip_utils, Cython.Utils, Cython.Plex.Actions, Cython.Plex.Transitions, Cython.Plex.Machines, Cython.Plex.DFA, Cython.Plex.Scanners, Cython.Compiler.Scanning, Cython.StringIOTree, Cython.Compiler.Code (total: 168)
[nightly] === Online benchmark dispatched for GROK; check logs in sgl-dev_v0.5.3.post3-rocm630-mi30x-20251022 ===
[nightly] === Starting post-processing (CSV processing, plot generation, Teams notifications) ===
[nightly] Processing online CSV data and generating plots... Logs will be saved to /mnt/raid/michael/sglang-ci/online/GROK1/v0.5.3.post3-rocm630-mi30x-20251022_GROK1_MOE-I4F8_online/process_and_generate_online_plots.log
[nightly] Using plot date from image tag: 20251022
[nightly] Sending Teams notification for grok online plots...
[nightly] Adding benchmark date to Teams notification: 20251022
[nightly] Teams notification using plot directory: /mnt/raid/michael/sglang-ci/plots_server
[nightly] Using GitHub upload for plot images (repo: ROCm/sglang-ci)
[nightly] Images will be stored in main branch with structure: plot/mi30x/model/mode/filename.png
[nightly] Including intelligent analysis (7 days lookback)
🐙 GitHub upload mode: Images will be uploaded to ROCm/sglang-ci
🐙 GitHub upload mode: Images will be uploaded to GitHub and embedded in Teams
📁 Plot directory: /mnt/raid/michael/sglang-ci/plots_server
🗂️  Benchmark directory: /mnt/raid/michael/sglang-ci
   🔍 Uploading 20251022_GROK1_online_standard.png to GitHub...
   📄 Creating new file: plot/mi30x/GROK1/online/20251022_GROK1_online_standard.png
   ✅ Uploaded to GitHub (log branch): 20251022_GROK1_online_standard.png
   🔗 GitHub URL: https://raw.githubusercontent.com/ROCm/sglang-ci/log/plot/mi30x/GROK1/online/20251022_GROK1_online_standard.png
🔍 Discovered 1 plot file(s) for grok online
   - 20251022_GROK1_online_standard.png -> ✅ uploaded to GitHub
🔍 Analyzing benchmark results for accuracy and performance...
   Found timing_summary log for grok online on 20251022: timing_summary_20251022_120034.log
   Found timing_summary log for grok online on 20251022: timing_summary_20251022_120034.log
   Found timing_summary log for grok online on 20251022: timing_summary_20251022_120034.log
🔍 Sending adaptive card with 1 image(s) hosted on GitHub
📊 Total payload size: 0.00MB
   📷 Image URL: https://raw.githubusercontent.com/ROCm/sglang-ci/log/plot/mi30x/GROK1/online/20251022_GROK1_online_standard.png
   💾 Debug: Card JSON saved to /tmp/teams_card_debug.json
✅ Successfully sent Teams notification for grok online plots
   (Power Automate flow accepted - message processing asynchronously)
🎉 Teams notification sent successfully! (with intelligent analysis)
[nightly] Teams notification sent successfully for grok online
[nightly] === Online post-processing completed for GROK ===
[nightly] ==========================================
[nightly] Completed benchmarks for image: rocm/sgl-dev:v0.5.3.post3-rocm630-mi30x-20251022
[nightly] Stopping container sgl-dev_v0.5.3.post3-rocm630-mi30x-20251022 to release resources...
[nightly] ==========================================
[nightly] ==========================================
[nightly] All benchmarks completed for 1 image(s)
[nightly] ==========================================
[nightly] Cleaning up process lock...
