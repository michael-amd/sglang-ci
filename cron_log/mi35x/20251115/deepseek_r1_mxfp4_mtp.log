[nightly] ==========================================
[nightly] SGL Nightly Benchmark Started
[nightly] ==========================================
[nightly] Command: scripts/perf_nightly.sh --model=deepseek --model-path=/mnt/raid/models/deepseek-ai/amd-DeepSeek-R1-MXFP4-Preview --model-name=DeepSeek-R1-MXFP4-Preview --mode=online --hardware=mi35x --enable-mtp-test --teams-webhook-url=https://prod-99.westus.logic.azure.com/workflows/44b23afb37e74288b6b006c60bbe65b2/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=ucbP9AJ9WeZtxe95Wmi8TfLUjiEo0AZSZP4Y_cNgWS0
[nightly] Start time: 2025-11-15 11:00:02 PST
[nightly] Machine: smci355-ccs-aus-m12-33
[nightly] Working directory: /mnt/raid/michael/sglang-ci
[nightly] Script location: /mnt/raid/michael/sglang-ci/scripts/perf_nightly.sh
[nightly] Process ID: 3215209
[nightly] ==========================================

[nightly] Runtime Environment:
[nightly] User: michaezh | Groups: michaezh sudo spack... | Docker: /usr/bin/docker
[nightly] Testing Docker daemon access...
[nightly] Docker daemon accessible - proceeding...
[nightly] Teams webhook URL provided via command line - notifications enabled
[nightly] DeepSeek MTP test enabled via command line
[nightly] Custom model path provided: /mnt/raid/models/deepseek-ai/amd-DeepSeek-R1-MXFP4-Preview
[nightly] Hardware: mi35x, ROCM Version: rocm700
[nightly] Custom model name provided: DeepSeek-R1-MXFP4-Preview
[nightly] Model: deepseek, Mode(s): online
[nightly] Created process lock: /tmp/perf_nightly_deepseek_mtp.lock
[nightly] GPU is busy. Attempting to stop running Docker containers...
[nightly] Stopping running containers: 2624c33c680c
[nightly] Waiting 15s for GPU to become idle...
[nightly] WARN: GPU may still be busy, but proceeding as requested.
[nightly] Searching for non-SRT images for deepseek for the last 1 days...
[nightly] Searching for non-SRT mi35x image (rocm700) in 'rocm/sgl-dev' for date 20251115...
[nightly] No image found for today. Checking yesterday as a fallback...
[nightly] Searching for non-SRT mi35x image (rocm700) in 'rocm/sgl-dev' for date 20251114...
[nightly] Fallback found candidate tag: v0.5.5.post2-rocm700-mi35x-20251114
[nightly] Found local image: rocm/sgl-dev:v0.5.5.post2-rocm700-mi35x-20251114
[nightly] Successfully obtained fallback image for date 20251114: rocm/sgl-dev:v0.5.5.post2-rocm700-mi35x-20251114
[nightly] Found 1 valid image(s) to run benchmarks on:
[nightly]   - rocm/sgl-dev:v0.5.5.post2-rocm700-mi35x-20251114

[nightly] ==========================================
[nightly] Starting benchmarks for image: rocm/sgl-dev:v0.5.5.post2-rocm700-mi35x-20251114
[nightly] ==========================================
[nightly] Checking GPU status before starting benchmarks for rocm/sgl-dev:v0.5.5.post2-rocm700-mi35x-20251114...
[nightly] GPU is busy. Attempting to stop running Docker containers...
[nightly] Stopping running containers: 9b4b3b969ac9
[nightly] Waiting 15s for GPU to become idle...
[nightly] WARN: GPU may still be busy, but proceeding as requested.
[nightly] Checking benchmark completion in: /mnt/raid/michael/sglang-ci/online/DeepSeek-R1-MXFP4-Preview/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_online
[nightly] Found 0 completed benchmark runs
[nightly] INFO: Found 0/15 completed runs for rocm/sgl-dev:v0.5.5.post2-rocm700-mi35x-20251114 (online). Proceeding with benchmarks.
[nightly] Using Docker image: rocm/sgl-dev:v0.5.5.post2-rocm700-mi35x-20251114
[nightly] Container name: sgl-dev_v0.5.5.post2-rocm700-mi35x-20251114
[nightly] Reusing container sgl-dev_v0.5.5.post2-rocm700-mi35x-20251114
[nightly] === Starting benchmark execution ===
[nightly] === Starting nightly DEEPSEEK online benchmark ===
[nightly] Launching deepseek_perf_online_csv.sh inside sgl-dev_v0.5.5.post2-rocm700-mi35x-20251114
[nightly] Passing --model-name='DeepSeek-R1-MXFP4-Preview' to DeepSeek benchmark
[nightly] Adding --enable-mtp-test flag for DeepSeek online benchmark
[mtp] MTP test enabled - setting runs per concurrency to 1
âœ… Parameter validation passed
[online] Script started at: 2025-11-15 11:00:44 PST
Scanning existing logs to check if all benchmarks are already complete...
Checking GSM8K log status...
âœ… GSM8K log file is complete with final accuracy summary
Checking serving benchmark logs...
Scan complete: 5 total runs needed, 0 missing/incomplete
âœ… All benchmark logs (serving + GSM8K) are present and complete! No server startup needed.
Skipping server startup and benchmark execution - generating CSV from existing logs...
[online] Structured CSV initialized at /mnt/raid/michael/sglang-ci/online/DeepSeek-R1-MXFP4-Preview/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_online_mtp_test/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_serving_mtp_test.csv
Extracting metrics for concurrency 128 from existing logs...
[online] Updating CSV for concurrency 128: E2E=76868.76ms, TTFT=14427.39ms, ITL=62.41ms, Output=(tok/s): tok/s
[online] CSV updated with results for concurrency 128
Extracting metrics for concurrency 64 from existing logs...
[online] Updating CSV for concurrency 64: E2E=41577.71ms, TTFT=798.98ms, ITL=49.28ms, Output=(tok/s): tok/s
[online] CSV updated with results for concurrency 64
Extracting metrics for concurrency 16 from existing logs...
[online] Updating CSV for concurrency 16: E2E=31289.40ms, TTFT=307.89ms, ITL=38.30ms, Output=(tok/s): tok/s
[online] CSV updated with results for concurrency 16
Extracting metrics for concurrency 4 from existing logs...
[online] Updating CSV for concurrency 4: E2E=28294.68ms, TTFT=224.88ms, ITL=35.13ms, Output=(tok/s): tok/s
[online] CSV updated with results for concurrency 4
Extracting metrics for concurrency 1 from existing logs...
[online] Updating CSV for concurrency 1: E2E=27284.36ms, TTFT=131.81ms, ITL=33.98ms, Output=(tok/s): tok/s
[online] CSV updated with results for concurrency 1
âœ… CSV generated from existing logs successfully.
Serving benchmark results written to /mnt/raid/michael/sglang-ci/online/DeepSeek-R1-MXFP4-Preview/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_online_mtp_test/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_serving_mtp_test.csv
Note: Both GSM8K and serving benchmarks were already complete
âœ… Serving benchmark completed successfully in 0 seconds (standard mode).
Structured serving benchmark results written to /mnt/raid/michael/sglang-ci/online/DeepSeek-R1-MXFP4-Preview/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_online_mtp_test/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_serving_mtp_test.csv
Individual concurrency logs saved to /mnt/raid/michael/sglang-ci/online/DeepSeek-R1-MXFP4-Preview/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_online_mtp_test/sglang_serving_benchmark_concurrency_*_run*.log
GSM8K accuracy results written to /mnt/raid/michael/sglang-ci/online/DeepSeek-R1-MXFP4-Preview/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_online_mtp_test/sglang_client_log_DeepSeek-R1-MXFP4-Preview_gsm8k.log
Shutting down SGLang server...
Server shutdown completed in 0 seconds

==========================================
SCRIPT EXECUTION SUMMARY
==========================================
Script completed at: 2025-11-15 11:00:44 PST
Total execution time: 0 seconds (0 minutes)
Output directory: /mnt/raid/michael/sglang-ci/online/DeepSeek-R1-MXFP4-Preview/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_online_mtp_test
Serving CSV: /mnt/raid/michael/sglang-ci/online/DeepSeek-R1-MXFP4-Preview/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_online_mtp_test/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_serving_mtp_test.csv
Timing log: /mnt/raid/michael/sglang-ci/online/DeepSeek-R1-MXFP4-Preview/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_online_mtp_test/timing_summary_20251115_110044.log
===========================================
Cleaning up...
[nightly] === Online benchmark dispatched for DEEPSEEK; check logs in sgl-dev_v0.5.5.post2-rocm700-mi35x-20251114 ===
[nightly] === Starting post-processing (CSV processing, plot generation, Teams notifications) ===
[nightly] Processing online CSV data and generating plots... Logs will be saved to /mnt/raid/michael/sglang-ci/online/DeepSeek-R1-MXFP4-Preview/v0.5.5.post2-rocm700-mi35x-20251114_DeepSeek-R1-MXFP4-Preview_FP8_online/process_and_generate_online_plots.log
[nightly] Using plot date from image tag: 20251114
[nightly] Sending Teams notification for deepseek online plots...
[nightly] Adding benchmark date to Teams notification: 20251114
[nightly] Teams notification using plot directory: /mnt/raid/michael/sglang-ci/plots_server
[nightly] Using GitHub upload for plot images (repo: ROCm/sglang-ci)
[nightly] Images will be stored in main branch with structure: plot/mi35x/model/mode/filename.png
[nightly] Including intelligent analysis (7 days lookback)
[nightly] Adding --enable-mtp-test flag for Teams notification
ğŸ™ GitHub upload mode: Images will be uploaded to ROCm/sglang-ci
ğŸ™ GitHub upload mode: Images will be uploaded to GitHub and embedded in Teams
ğŸ“ Plot directory: /mnt/raid/michael/sglang-ci/plots_server
ğŸ—‚ï¸  Benchmark directory: /mnt/raid/michael/sglang-ci
ğŸš€ MTP mode: Including DeepSeek R1 throughput artifacts
   ğŸ” Uploading 20251114_DeepSeek-R1-MXFP4-Preview_online_all.png to GitHub...
   ğŸ“‹ Log branch already exists
   ğŸ“ Updating existing file: plot/mi35x/DeepSeek-R1-MXFP4-Preview/online/20251114_DeepSeek-R1-MXFP4-Preview_online_all.png
   âœ… Uploaded to GitHub (log branch): 20251114_DeepSeek-R1-MXFP4-Preview_online_all.png
   ğŸ”— GitHub URL: https://github.com/ROCm/sglang-ci/blob/log/plot/mi35x/DeepSeek-R1-MXFP4-Preview/online/20251114_DeepSeek-R1-MXFP4-Preview_online_all.png
   No timing_summary log found for deepseek online on 20251115 - benchmark may not have run yet
   Found timing_summary log for deepseek online on 20251114: timing_summary_20251115_110044.log
   Found timing_summary log for deepseek online on 20251113: timing_summary_20251113_174619.log
ğŸ” Discovered 1 plot file(s) for deepseek online
   - 20251114_DeepSeek-R1-MXFP4-Preview_online_all.png -> âœ… uploaded to GitHub
ğŸ” Analyzing benchmark results for accuracy and performance...
   Found timing_summary log for deepseek online on 20251114: timing_summary_20251115_110044.log
   Found timing_summary log for deepseek online on 20251114: timing_summary_20251115_110044.log
   Found timing_summary log for deepseek online on 20251114: timing_summary_20251115_110044.log
   Found timing_summary log for deepseek online on 20251114: timing_summary_20251115_110044.log
ğŸ” Sending adaptive card with 1 image(s) hosted on GitHub
ğŸ“Š Total payload size: 0.00MB
   ğŸ“· Image URL: https://github.com/ROCm/sglang-ci/blob/log/plot/mi35x/DeepSeek-R1-MXFP4-Preview/online/20251114_DeepSeek-R1-MXFP4-Preview_online_all.png
   ğŸ’¾ Debug: Card JSON saved to /tmp/teams_card_debug.json
âœ… Successfully sent Teams notification for deepseek online plots
   (Power Automate flow accepted - message processing asynchronously)
ğŸ‰ Teams notification sent successfully! (with intelligent analysis)
[nightly] Teams notification sent successfully for deepseek online
[nightly] === Online post-processing completed for DEEPSEEK ===
[nightly] ==========================================
[nightly] Completed benchmarks for image: rocm/sgl-dev:v0.5.5.post2-rocm700-mi35x-20251114
[nightly] Stopping container sgl-dev_v0.5.5.post2-rocm700-mi35x-20251114 to release resources...
[nightly] ==========================================
[nightly] ==========================================
[nightly] All benchmarks completed for 1 image(s)
[nightly] ==========================================
[nightly] Cleaning up process lock...
